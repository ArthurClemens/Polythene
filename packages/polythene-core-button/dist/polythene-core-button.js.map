{"version":3,"file":"polythene-core-button.js","sources":["../src/raised-button.js","../../polythene-css-classes/button.js","../src/button.js"],"sourcesContent":["import { isServer, pointerStartMoveEvent, pointerEndMoveEvent, deprecation } from \"polythene-core\";\n\n// Don't export 'getElement': it will be the wrapped Button component (set in polythene-xxx-button)\n\nconst DEFAULT_SHADOW_DEPTH = 1;\nconst DEFAULT_SHADOW_DEPTH_INCREASE = 1;\nconst MAX_SHADOW_DEPTH = 5;\n\nlet tapStart,\n  tapEndAll = () => {},\n  downButtons = [];\n\nconst animateZ = (which, vnode) => {\n  const shadowDepthBase = vnode.state.shadowDepthBase;\n  const increase = vnode.attrs.increase || DEFAULT_SHADOW_DEPTH_INCREASE;\n  const shadowDepth = vnode.state.shadowDepth();\n  const newShadowDepth = which === \"down\" && shadowDepthBase < MAX_SHADOW_DEPTH\n    ? Math.min(shadowDepthBase + increase, MAX_SHADOW_DEPTH)\n    : which === \"up\"\n      ? Math.max(shadowDepth - increase, shadowDepthBase)\n      : shadowDepth;\n  if (newShadowDepth !== shadowDepth) {\n    vnode.state.shadowDepth(newShadowDepth);\n  }\n};\n\nconst tapHandler = (which, vnode) => {\n  if (which === \"down\") {\n    downButtons.push(Object.assign({}, vnode));\n  }\n  const animateOnTap = vnode.attrs.animateOnTap !== false ? true : false;\n  if (animateOnTap) {\n    animateZ(which, vnode);\n  }\n};\n\nconst initTapEvents = vnode => {\n  if (isServer) return;\n  tapStart = () => tapHandler(\"down\", vnode);\n  tapEndAll = () => {\n    downButtons.map(buttonVnode =>\n      tapHandler(\"up\", buttonVnode));\n    downButtons = [];\n  };\n  pointerStartMoveEvent.forEach(evt =>\n    vnode.dom.addEventListener(evt, tapStart));\n  pointerEndMoveEvent.forEach(evt =>\n    document.addEventListener(evt, tapEndAll));\n};\n\nconst clearTapEvents = vnode => {\n  pointerStartMoveEvent.forEach(evt =>\n    vnode.dom.removeEventListener(evt, tapStart));\n  pointerEndMoveEvent.forEach(evt =>\n    document.removeEventListener(evt, tapEndAll));\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n  const shadowDepthBase = attrs.shadowDepth !== undefined\n    ? attrs.shadowDepth\n    : attrs.z !== undefined // deprecated\n      ? attrs.z\n      : DEFAULT_SHADOW_DEPTH; \n  const shadowDepth = createStream(shadowDepthBase);\n  const tapEventsInited = createStream(false);\n  return {\n    shadowDepthBase,\n    shadowDepth,\n    tapEventsInited,\n    redrawOnUpdate: createStream.merge([shadowDepth])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (attrs.z !== undefined) {\n    deprecation(\"RaisedButton\", { option: \"z\", newOption: \"shadowDepth\" });\n  }\n  if (!state.tapEventsInited()) {\n    initTapEvents(vnode);\n    state.tapEventsInited(true);\n  }\n};\n\nexport const onUnMount = vnode => {\n  if (vnode.state.tapEventsInited()) {\n    clearTapEvents(vnode);\n  }\n};\n\nexport const createProps = vnode => {\n  const attrs = vnode.attrs;\n  const state = vnode.state;\n  const children = attrs.children || vnode.children || [];\n  return {\n    raised: true,\n    animateOnTap: false,\n    wash: attrs.wash !== undefined\n      ? attrs.wash\n      : false,\n    children,\n    ...attrs,\n    shadowDepth: attrs.disabled ? 0 : state.shadowDepth(),\n  };\n};\n\nexport const createContent = vnode =>\n  vnode.children;\n","\nexport default {\n  component:        \"pe-text-button\",\n  super:            \"pe-button\",\n  row:              \"pe-button-row\",\n      \n  // elements      \n  content:          \"pe-button__content\",\n  label:            \"pe-button__label\",\n  textLabel:        \"pe-button__text-label\",\n  wash:             \"pe-button__wash\",\n  dropdown:         \"pe-button__dropdown\",\n      \n  // states      \n  border:           \"pe-button--border\",\n  contained:        \"pe-button--contained\",\n  disabled:         \"pe-button--disabled\",\n  dropdownClosed:   \"pe-button--dropdown-closed\",\n  dropdownOpen:     \"pe-button--dropdown-open\",\n  extraWide:        \"pe-button--extra-wide\",\n  hasDropdown:      \"pe-button--dropdown\",\n  highLabel:        \"pe-button--high-label\",\n  inactive:         \"pe-button--inactive\",\n  raised:           \"pe-button--raised\",\n  selected:         \"pe-button--selected\",\n  separatorAtStart: \"pe-button--separator-start\",\n};\n","// @ts-check\n\nimport { filterSupportedAttributes, isClient, deprecation, iconDropdownDown } from \"polythene-core\";\nimport classes from \"polythene-css-classes/button\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"a\";\n\nexport const getInitialState = (vnode, createStream) => {\n  const dom = createStream(null);\n  const focus = createStream(false);\n  const inactive = createStream(false);\n  const mouseover = createStream(false);\n  return {\n    dom,\n    focus,\n    inactive,\n    mouseover,\n    redrawOnUpdate: createStream.merge([dom, focus, inactive])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (attrs.borders !== undefined) {\n    deprecation(\"Button\", { option: \"borders\", newOption: \"border\" });\n  }\n  state.dom(vnode.dom);\n  \n  if (isClient) {\n    const handleInactivate = () => (\n      state.inactive(true),\n      setTimeout(() => (\n        state.inactive(false)\n      ), attrs.inactivate * 1000)\n    );\n\n    const onFocus = () => state.focus(!state.mouseover());\n    const onBlur = () => state.focus(false);\n    const onMouseOver = () => state.mouseover(true);\n    const onMouseOut = () => state.mouseover(false);\n    const onClick = handleInactivate;\n\n    vnode.dom.addEventListener(\"focus\", onFocus, false);\n    vnode.dom.addEventListener(\"blur\", onBlur, false);\n    vnode.dom.addEventListener(\"mouseover\", onMouseOver, false);\n    vnode.dom.addEventListener(\"mouseout\", onMouseOut, false);\n    vnode.dom.addEventListener(\"click\", onClick, false);\n\n    state.removeEventListeners = () => (\n      vnode.dom.removeEventListener(\"focus\", onFocus, false),\n      vnode.dom.removeEventListener(\"blur\", onBlur, false),\n      vnode.dom.removeEventListener(\"mouseover\", onBlur, false),\n      vnode.dom.removeEventListener(\"mouseout\", onMouseOut, false),\n      vnode.dom.removeEventListener(\"click\", onClick, false)\n    );\n  }\n};\n\nexport const onUnMount = vnode =>\n  vnode.state.removeEventListeners && vnode.state.removeEventListeners();\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const disabled = attrs.disabled;\n  const inactive = attrs.inactive || state.inactive();\n  const onClickHandler = attrs.events && attrs.events[k.onclick];\n  const onKeyUpHandler = (attrs.events && attrs.events[k.onkeyup]) || onClickHandler;\n\n  return Object.assign(\n    {}, \n    filterSupportedAttributes(attrs, { add: [k.formaction, \"type\"], remove: [\"style\"] }), // Set style on content, not on component\n    attrs.testId && { \"data-test-id\": attrs.testId },\n    {\n      className: [\n        classes.super,\n        attrs.parentClassName || classes.component,\n        attrs.contained ? classes.contained : null,\n        attrs.raised ? classes.contained : null,\n        attrs.raised ? classes.raised : null,\n        attrs.selected ? classes.selected : null,\n        attrs.highLabel ? classes.highLabel : null,\n        attrs.extraWide ? classes.extraWide : null,\n        disabled ? classes.disabled : null,\n        inactive ? classes.inactive : null,\n        attrs.separatorAtStart ? classes.separatorAtStart : null,\n        (attrs.border || attrs.borders) ? classes.border : null,\n        attrs.dropdown ? classes.hasDropdown : null,\n        attrs.dropdown\n          ? attrs.dropdown.open\n            ? classes.dropdownOpen\n            : classes.dropdownClosed\n          : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \")\n    },\n    attrs.events,\n    inactive ? null : {\n      [k.tabindex]: disabled || inactive\n        ? -1\n        : attrs[k.tabindex] || 0,\n      [k.onclick]: onClickHandler,\n      [k.onkeyup]: e => {\n        if (e.keyCode === 13 && state.focus()) {\n          state.focus(false);\n          if (onKeyUpHandler) {\n            onKeyUpHandler(e);\n          }\n        }\n      }\n    },\n    attrs.url,\n    disabled ? { disabled: true } : null\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k, Ripple, Icon, Shadow }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const noink = attrs.ink !== undefined && attrs.ink === false;\n  const disabled = attrs.disabled;\n  const children = attrs.children || vnode.children;\n  const label = attrs.content\n    ? attrs.content\n    : attrs.label !== undefined\n      ? typeof attrs.label === \"object\"\n        ? attrs.label\n        : h(\"div\",\n          { className: classes.label },\n          h(\"div\",\n            {\n              className: classes.textLabel,\n              style: attrs.textStyle\n            },\n            attrs.label\n          )\n        )\n      : children\n        ? children\n        : null;\n  const noWash = disabled || (attrs.wash !== undefined && !attrs.wash);\n  return h(\"div\",\n    {\n      [k.class]: classes.content,\n      style: attrs.style\n    },\n    [\n      h(Shadow, {\n        key: \"shadow\",\n        shadowDepth: attrs.shadowDepth !== undefined\n          ? attrs.shadowDepth\n          : 0,\n        animated: true\n      }),\n      // Ripple\n      disabled || noink || !Ripple || (h[\"displayName\"] === \"react\" ? !state.dom() : false)\n        // somehow Mithril does not update when the dom stream is updated\n        ? null\n        : h(Ripple, Object.assign({},\n          {\n            key: \"ripple\",\n            target: state.dom()\n          },\n          attrs.ripple\n        )),\n      // hover\n      noWash ? null : h(\"div\", { key: \"wash\", className: classes.wash }),\n      label,\n      attrs.dropdown\n        ? h(Icon,\n          {\n            className: classes.dropdown,\n            key: \"dropdown\",\n            svg: { content: h.trust(iconDropdownDown) }\n          }\n        )\n        : null\n    ]\n  );\n};\n"],"names":["tapStart","component","super","row","content","label","textLabel","wash","dropdown","border","contained","disabled","dropdownClosed","dropdownOpen","extraWide","hasDropdown","highLabel","inactive","raised","selected","separatorAtStart","vnode","attrs","element","createStream","dom","focus","mouseover","redrawOnUpdate","merge","state","undefined","borders","deprecation","option","newOption","isClient","onFocus","onBlur","onMouseOut","onClick","setTimeout","inactivate","addEventListener","removeEventListeners","removeEventListener","k","keys","onClickHandler","events","onclick","onKeyUpHandler","onkeyup","_extends","filterSupportedAttributes","add","formaction","remove","testId","className","classes","parentClassName","open","tone","class","join","tabindex","e","keyCode","url","h","renderer","Ripple","Icon","Shadow","noink","ink","children","_typeof","style","textStyle","noWash","key","shadowDepth","animated","target","ripple","svg","trust","iconDropdownDown","tapEndAll","downButtons","tapHandler","which","push","animateOnTap","shadowDepthBase","increase","newShadowDepth","Math","min","max","animateZ","z","tapEventsInited","isServer","map","buttonVnode","pointerStartMoveEvent","forEach","evt","pointerEndMoveEvent","document","initTapEvents","clearTapEvents"],"mappings":"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"}