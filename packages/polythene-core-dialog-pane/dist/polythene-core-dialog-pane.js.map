{"version":3,"file":"polythene-core-dialog-pane.js","sources":["../../polythene-css-classes/dialog-pane.js","../../polythene-css-classes/button.js","../src/dialog-pane.js"],"sourcesContent":["\nexport default {\n  component:         \"pe-dialog-pane\",\n\n  // elements\n  actions:           \"pe-dialog-pane__actions\",\n  body:              \"pe-dialog-pane__body\",\n  content:           \"pe-dialog-pane__content\",\n  footer:            \"pe-dialog-pane__footer\",\n  header:            \"pe-dialog-pane__header\",\n  title:             \"pe-dialog-pane__title\",\n\n  // states\n  withHeader:        \"pe-dialog-pane--header\",\n  withFooter:        \"pe-dialog-pane--footer\",\n  headerWithTitle:   \"pe-dialog-pane__header--title\",\n  footerWithButtons: \"pe-dialog-pane__footer--buttons\",\n  footerHigh:        \"pe-dialog-pane__footer--high\",\n  borderBottom:      \"pe-dialog-pane--border-bottom\",\n  borderTop:         \"pe-dialog-pane--border-top\",\n  fullBleed:         \"pe-dialog-pane--body-full-bleed\",\n};\n","\nexport default {\n  component:        \"pe-text-button\",\n  super:            \"pe-button\",\n  row:              \"pe-button-row\",\n      \n  // elements      \n  content:          \"pe-button__content\",\n  label:            \"pe-button__label\",\n  textLabel:        \"pe-button__text-label\",\n  wash:             \"pe-button__wash\",\n  dropdown:         \"pe-button__dropdown\",\n      \n  // states      \n  border:           \"pe-button--border\",\n  contained:        \"pe-button--contained\",\n  disabled:         \"pe-button--disabled\",\n  dropdownClosed:   \"pe-button--dropdown-closed\",\n  dropdownOpen:     \"pe-button--dropdown-open\",\n  extraWide:        \"pe-button--extra-wide\",\n  hasDropdown:      \"pe-button--dropdown\",\n  highLabel:        \"pe-button--high-label\",\n  inactive:         \"pe-button--inactive\",\n  raised:           \"pe-button--raised\",\n  selected:         \"pe-button--selected\",\n  separatorAtStart: \"pe-button--separator-start\",\n};\n","import { filterSupportedAttributes, unpackAttrs, subscribe, unsubscribe } from \"polythene-core\";\nimport classes from \"polythene-css-classes/dialog-pane\";\nimport buttonClasses from \"polythene-css-classes/button\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"form\";\n\nconst SCROLL_WATCH_END_TIMER = 150;\n\nconst updateScrollOverflowState = vnode => {\n  const state = vnode.state;\n  const scroller = state.scrollEl();\n  if (!scroller) {\n    return;\n  }\n  state.topOverflow(scroller.scrollTop > 0);\n  state.bottomOverflow(scroller.scrollHeight - (scroller.scrollTop + scroller.getBoundingClientRect().height) > 0);\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const bottomOverflow = createStream(false); \n  const footerEl = createStream(null);\n  const headerEl = createStream(null);\n  const isScrolling = createStream(false);\n  const scrollEl = createStream(null);\n  const topOverflow = createStream(false);\n  const el = createStream(null);\n  \n  return {\n    cleanUp: undefined,\n    bottomOverflow,\n    el,\n    footerEl,\n    headerEl,\n    isScrolling,\n    scrollEl,\n    scrollWatchId: undefined,\n    topOverflow,\n    redrawOnUpdate: createStream.merge([topOverflow, bottomOverflow, isScrolling])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const dom = vnode.dom;\n  const state = vnode.state;\n  state.el(dom);\n\n  state.scrollEl(dom.querySelector(`.${classes.body}`));\n  state.footerEl(dom.querySelector(`.${classes.footer}`));\n  state.headerEl(dom.querySelector(`.${classes.header}`));\n\n  state.isScrolling.map(() =>\n    updateScrollOverflowState(vnode)\n  );\n\n  const update = () => {\n    updateScrollOverflowState(vnode);\n  };\n\n  state.cleanUp = () => (\n    unsubscribe(\"resize\", update)\n  );\n\n  // resize: update scroll state (\"overflow\" borders)\n  subscribe(\"resize\", update);\n\n  update();\n};\n\nexport const onUnMount = vnode => (\n  vnode.state.cleanUp()\n);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n  const withHeader = attrs.header !== undefined || attrs.title !== undefined;\n  const withFooter = attrs.footer !== undefined || attrs.footerButtons !== undefined;\n  const borders = attrs.borders || \"overflow\";\n  const showTopBorder = borders === \"always\" || (withHeader && borders === \"overflow\" && state.topOverflow());\n  const showBottomBorder = borders === \"always\" || (withFooter && borders === \"overflow\" && state.bottomOverflow());\n  \n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    {\n      className: [\n        classes.component,\n        attrs.fullBleed ? classes.fullBleed : null,\n        showTopBorder ? classes.borderTop : null,\n        showBottomBorder ? classes.borderBottom : null,\n        withHeader ? classes.withHeader : null,\n        withFooter ? classes.withFooter : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    attrs.formOptions\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n\n  return h(\"div\",\n    {\n      className: [\n        classes.content,\n        attrs.menu ? classes.menuContent : null\n      ].join(\" \"),\n      style: attrs.style\n    },\n    [\n      attrs.header\n        ? attrs.header\n        : attrs.title\n          ? h(\"div\",\n            {\n              className: [\n                classes.header,\n                classes.headerWithTitle\n              ].join(\" \"),\n              key: \"title\"\n            },\n            h(\"div\",\n              { className: classes.title },\n              attrs.title\n            )\n          )\n          : null,\n      h(\"div\",\n        {\n          className: classes.body,\n          key: \"body\",\n          [k.onscroll]: () => {\n            state.isScrolling(true);\n            clearTimeout(state.scrollWatchId);\n            state.scrollWatchId = setTimeout(() => {\n              state.isScrolling(false);\n            }, SCROLL_WATCH_END_TIMER);\n          }\n        },\n        attrs.content || attrs.body || attrs.menu\n      ),\n      attrs.footer\n        ? h(\"div\",\n          {\n            className: classes.footer,\n            key: \"footer\"\n          },\n          attrs.footer\n        )\n        : attrs.footerButtons\n          ? h(\"div\",\n            {\n              className: [\n                classes.footer,\n                classes.footerWithButtons,\n                buttonClasses.row\n              ].join(\" \"),\n              key: \"footer\"\n            },\n            h(\"div\",\n              { className: classes.actions },\n              attrs.footerButtons\n            )\n          )\n          : null\n    ]\n  );\n};\n"],"names":["component","actions","body","content","footer","header","title","withHeader","withFooter","headerWithTitle","footerWithButtons","footerHigh","borderBottom","borderTop","fullBleed","super","row","label","textLabel","wash","dropdown","border","contained","disabled","dropdownClosed","dropdownOpen","extraWide","hasDropdown","highLabel","inactive","raised","selected","separatorAtStart","updateScrollOverflowState","vnode","state","scroller","scrollEl","topOverflow","scrollTop","bottomOverflow","scrollHeight","getBoundingClientRect","height","attrs","element","createStream","footerEl","headerEl","isScrolling","cleanUp","undefined","el","scrollWatchId","redrawOnUpdate","merge","dom","querySelector","classes","map","update","unsubscribe","subscribe","keys","k","unpackAttrs","footerButtons","borders","showTopBorder","showBottomBorder","Object","assign","filterSupportedAttributes","remove","className","tone","class","join","formOptions","renderer","h","menu","menuContent","style","key","onscroll","clearTimeout","setTimeout","buttonClasses"],"mappings":"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"}