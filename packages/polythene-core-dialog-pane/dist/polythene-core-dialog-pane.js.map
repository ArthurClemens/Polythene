{"version":3,"file":"polythene-core-dialog-pane.js","sources":["../../polythene-css-classes/dialog-pane.js","../../polythene-css-classes/button.js","../src/dialog-pane.js"],"sourcesContent":["\nexport default {\n  component:         \"pe-dialog-pane\",\n\n  // elements\n  actions:           \"pe-dialog-pane__actions\",\n  body:              \"pe-dialog-pane__body\",\n  content:           \"pe-dialog-pane__content\",\n  footer:            \"pe-dialog-pane__footer\",\n  header:            \"pe-dialog-pane__header\",\n  title:             \"pe-dialog-pane__title\",\n\n  // states\n  withHeader:        \"pe-dialog-pane--header\",\n  withFooter:        \"pe-dialog-pane--footer\",\n  headerWithTitle:   \"pe-dialog-pane__header--title\",\n  footerWithButtons: \"pe-dialog-pane__footer--buttons\",\n  footerHigh:        \"pe-dialog-pane__footer--high\",\n  borderBottom:      \"pe-dialog-pane--border-bottom\",\n  borderTop:         \"pe-dialog-pane--border-top\",\n  fullBleed:         \"pe-dialog-pane--body-full-bleed\",\n};\n","\nexport default {\n  component:        \"pe-text-button\",\n  super:            \"pe-button\",\n  row:              \"pe-button-row\",\n      \n  // elements      \n  content:          \"pe-button__content\",\n  label:            \"pe-button__label\",\n  textLabel:        \"pe-button__text-label\",\n  wash:             \"pe-button__wash\",\n  dropdown:         \"pe-button__dropdown\",\n      \n  // states      \n  border:           \"pe-button--border\",\n  contained:        \"pe-button--contained\",\n  disabled:         \"pe-button--disabled\",\n  dropdownClosed:   \"pe-button--dropdown-closed\",\n  dropdownOpen:     \"pe-button--dropdown-open\",\n  extraWide:        \"pe-button--extra-wide\",\n  hasDropdown:      \"pe-button--dropdown\",\n  highLabel:        \"pe-button--high-label\",\n  inactive:         \"pe-button--inactive\",\n  raised:           \"pe-button--raised\",\n  selected:         \"pe-button--selected\",\n  separatorAtStart: \"pe-button--separator-start\",\n};\n","import { filterSupportedAttributes, unpackAttrs, subscribe, unsubscribe } from \"polythene-core\";\nimport classes from \"polythene-css-classes/dialog-pane\";\nimport buttonClasses from \"polythene-css-classes/button\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"form\";\n\nconst SCROLL_WATCH_END_TIMER = 150;\n\nconst updateScrollOverflowState = vnode => {\n  const state = vnode.state;\n  const scroller = state.scrollEl();\n  if (!scroller) {\n    return;\n  }\n  state.topOverflow(scroller.scrollTop > 0);\n  state.bottomOverflow(scroller.scrollHeight - (scroller.scrollTop + scroller.getBoundingClientRect().height) > 0);\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const bottomOverflow = createStream(false); \n  const footerEl = createStream(null);\n  const headerEl = createStream(null);\n  const isScrolling = createStream(false);\n  const scrollEl = createStream(null);\n  const topOverflow = createStream(false);\n  const el = createStream(null);\n  \n  return {\n    cleanUp: undefined,\n    bottomOverflow,\n    el,\n    footerEl,\n    headerEl,\n    isScrolling,\n    scrollEl,\n    scrollWatchId: undefined,\n    topOverflow,\n    redrawOnUpdate: createStream.merge([topOverflow, bottomOverflow, isScrolling])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const dom = vnode.dom;\n  const state = vnode.state;\n  state.el(dom);\n\n  state.scrollEl(dom.querySelector(`.${classes.body}`));\n  state.footerEl(dom.querySelector(`.${classes.footer}`));\n  state.headerEl(dom.querySelector(`.${classes.header}`));\n\n  state.isScrolling.map(() =>\n    updateScrollOverflowState(vnode)\n  );\n\n  const update = () => {\n    updateScrollOverflowState(vnode);\n  };\n\n  state.cleanUp = () => (\n    unsubscribe(\"resize\", update)\n  );\n\n  // resize: update scroll state (\"overflow\" borders)\n  subscribe(\"resize\", update);\n\n  update();\n};\n\nexport const onUnMount = vnode => (\n  vnode.state.cleanUp()\n);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n  const withHeader = attrs.header !== undefined || attrs.title !== undefined;\n  const withFooter = attrs.footer !== undefined || attrs.footerButtons !== undefined;\n  const borders = attrs.borders || \"overflow\";\n  const showTopBorder = borders === \"always\" || (withHeader && borders === \"overflow\" && state.topOverflow());\n  const showBottomBorder = borders === \"always\" || (withFooter && borders === \"overflow\" && state.bottomOverflow());\n  \n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    {\n      className: [\n        classes.component,\n        attrs.fullBleed ? classes.fullBleed : null,\n        showTopBorder ? classes.borderTop : null,\n        showBottomBorder ? classes.borderBottom : null,\n        withHeader ? classes.withHeader : null,\n        withFooter ? classes.withFooter : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    attrs.formOptions\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n\n  return h(\"div\",\n    {\n      className: [\n        classes.content,\n        attrs.menu ? classes.menuContent : null\n      ].join(\" \"),\n      style: attrs.style\n    },\n    [\n      attrs.header\n        ? attrs.header\n        : attrs.title\n          ? h(\"div\",\n            {\n              className: [\n                classes.header,\n                classes.headerWithTitle\n              ].join(\" \"),\n              key: \"title\"\n            },\n            h(\"div\",\n              { className: classes.title },\n              attrs.title\n            )\n          )\n          : null,\n      h(\"div\",\n        {\n          className: classes.body,\n          key: \"body\",\n          [k.onscroll]: () => {\n            state.isScrolling(true);\n            clearTimeout(state.scrollWatchId);\n            state.scrollWatchId = setTimeout(() => {\n              state.isScrolling(false);\n            }, SCROLL_WATCH_END_TIMER);\n          }\n        },\n        attrs.content || attrs.body || attrs.menu\n      ),\n      attrs.footer\n        ? h(\"div\",\n          {\n            className: classes.footer,\n            key: \"footer\"\n          },\n          attrs.footer\n        )\n        : attrs.footerButtons\n          ? h(\"div\",\n            {\n              className: [\n                classes.footer,\n                classes.footerWithButtons,\n                buttonClasses.row\n              ].join(\" \"),\n              key: \"footer\"\n            },\n            h(\"div\",\n              { className: classes.actions },\n              attrs.footerButtons\n            )\n          )\n          : null\n    ]\n  );\n};\n"],"names":["component","actions","body","content","footer","header","title","withHeader","withFooter","headerWithTitle","footerWithButtons","footerHigh","borderBottom","borderTop","fullBleed","super","row","label","textLabel","wash","dropdown","border","contained","disabled","dropdownClosed","dropdownOpen","extraWide","hasDropdown","highLabel","inactive","raised","selected","separatorAtStart","getElement","vnode","attrs","element","SCROLL_WATCH_END_TIMER","updateScrollOverflowState","state","scroller","scrollEl","topOverflow","scrollTop","bottomOverflow","scrollHeight","getBoundingClientRect","height","getInitialState","createStream","footerEl","headerEl","isScrolling","el","cleanUp","undefined","scrollWatchId","redrawOnUpdate","merge","onMount","dom","querySelector","classes","map","update","unsubscribe","subscribe","onUnMount","createProps","keys","k","unpackAttrs","footerButtons","borders","showTopBorder","showBottomBorder","Object","assign","filterSupportedAttributes","remove","className","tone","class","join","formOptions","createContent","renderer","h","menu","menuContent","style","key","onscroll","clearTimeout","setTimeout","buttonClasses"],"mappings":"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"}