{"version":3,"file":"polythene-core-dialog-pane.js","sources":["../../polythene-css-classes/dialog-pane.js","../../polythene-css-classes/button.js","../src/dialog-pane.js","../src/vars.js"],"sourcesContent":["\nexport default {\n  component:         \"pe-dialog-pane\",\n\n  // elements\n  actions:           \"pe-dialog-pane__actions\",\n  body:              \"pe-dialog-pane__body\",\n  content:           \"pe-dialog-pane__content\",\n  footer:            \"pe-dialog-pane__footer\",\n  header:            \"pe-dialog-pane__header\",\n  title:             \"pe-dialog-pane__title\",\n\n  // states\n  withHeader:        \"pe-dialog-pane--header\",\n  withFooter:        \"pe-dialog-pane--footer\",\n  headerWithTitle:   \"pe-dialog-pane__header--title\",\n  footerWithButtons: \"pe-dialog-pane__footer--buttons\",\n  footerHigh:        \"pe-dialog-pane__footer--high\",\n  borderBottom:      \"pe-dialog-pane--border-bottom\",\n  borderTop:         \"pe-dialog-pane--border-top\",\n  fullBleed:         \"pe-dialog-pane--body-full-bleed\",\n};\n","\nexport default {\n  base:           \"pe-button\",\n  component:      \"pe-button pe-text-button\",\n  row:            \"pe-button-row\",\n    \n  // elements    \n  content:        \"pe-button__content\",\n  focus:          \"pe-button__focus\",\n  label:          \"pe-button__label\",\n  wash:           \"pe-button__wash\",\n  dropdown:       \"pe-button__dropdown\",\n    \n  // states    \n  border:         \"pe-button--border\",\n  disabled:       \"pe-button--disabled\",\n  focused:        \"pe-button--focus\",\n  inactive:       \"pe-button--inactive\",\n  selected:       \"pe-button--selected\",\n  hasDropdown:    \"pe-button--dropdown\",\n  highLabel:      \"pe-button--high-label\",\n  extraWide:      \"pe-button--extra-wide\",\n};\n","import { filterSupportedAttributes, unpackAttrs, subscribe, unsubscribe } from \"polythene-core\";\nimport classes from \"polythene-css-classes/dialog-pane\";\nimport buttonClasses from \"polythene-css-classes/button\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"form\";\n\nconst SCROLL_WATCH_END_TIMER = 150;\n\nconst updateScrollOverflowState = vnode => {\n  const state = vnode.state;\n  const scroller = state.scrollEl();\n  if (!scroller) {\n    return;\n  }\n  state.topOverflow(scroller.scrollTop > 0);\n  state.bottomOverflow(scroller.scrollHeight - (scroller.scrollTop + scroller.getBoundingClientRect().height) > 0);\n};\n\nconst updateFooterState = vnode => {\n  const state = vnode.state;\n  const footerEl = state.footerEl();\n  if (!footerEl) {\n    return;\n  }\n  const style = window.getComputedStyle(footerEl);\n  const height = footerEl.getBoundingClientRect().height;\n  const minHeight = parseInt(style.minHeight, 10);\n  if (height > minHeight) {\n    footerEl.classList.add(classes.footerHigh);\n  } else {\n    footerEl.classList.remove(classes.footerHigh);\n  }\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const bottomOverflow = createStream(false); \n  const footerEl = createStream(null);\n  const headerEl = createStream(null);\n  const isScrolling = createStream(false);\n  const scrollEl = createStream(null);\n  const topOverflow = createStream(false);\n  const el = createStream(null);\n  \n  return {\n    cleanUp: undefined,\n    bottomOverflow,\n    el,\n    footerEl,\n    headerEl,\n    isScrolling,\n    scrollEl,\n    scrollWatchId: undefined,\n    topOverflow,\n    redrawOnUpdate: createStream.merge([topOverflow, bottomOverflow, isScrolling])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const dom = vnode.dom;\n  const state = vnode.state;\n  state.el(dom);\n\n  state.scrollEl(dom.querySelector(`.${classes.body}`));\n  state.footerEl(dom.querySelector(`.${classes.footer}`));\n  state.headerEl(dom.querySelector(`.${classes.title}`));\n\n  state.isScrolling.map(() =>\n    updateScrollOverflowState(vnode)\n  );\n\n  const update = () => {\n    updateScrollOverflowState(vnode);\n    updateFooterState(vnode);\n  };\n\n  state.cleanUp = () => (\n    unsubscribe(\"resize\", update)\n  );\n\n  // resize: update scroll state (\"overflow\" borders)\n  subscribe(\"resize\", update);\n  \n  updateScrollOverflowState(vnode);\n};\n\nexport const onUnMount = vnode => (\n  vnode.state.cleanUp()\n);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n  const borders = attrs.borders || \"overflow\";\n  const showTopBorder = borders === \"always\" || (borders === \"overflow\" && state.topOverflow());\n  const showBottomBorder = borders === \"always\" || (borders === \"overflow\" && state.bottomOverflow());\n  const withHeader = attrs.header !== undefined || attrs.title !== undefined;\n  const withFooter = attrs.footer !== undefined || attrs.footerButtons !== undefined;\n  \n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    {\n      className: [\n        classes.component,\n        attrs.fullBleed ? classes.fullBleed : null,\n        showTopBorder ? classes.borderTop : null,\n        showBottomBorder ? classes.borderBottom : null,\n        withHeader ? classes.withHeader : null,\n        withFooter ? classes.withFooter : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n    },\n    attrs.formOptions\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k }) => {\n  const state = vnode.state;\n  const attrs = unpackAttrs(vnode.attrs);\n\n  return h(\"div\",\n    {\n      className: [\n        classes.content,\n        attrs.menu ? classes.menuContent : null\n      ].join(\" \"),\n      style: attrs.style\n    },\n    [\n      attrs.header\n        ? attrs.header\n        : attrs.title\n          ? h(\"div\",\n            {\n              className: [\n                classes.header,\n                classes.headerWithTitle\n              ].join(\" \"),\n              key: \"title\"\n            },\n            h(\"div\",\n              { className: classes.title },\n              attrs.title\n            )\n          )\n          : null,\n      h(\"div\",\n        {\n          className: classes.body,\n          key: \"body\",\n          [k.onscroll]: () => {\n            state.isScrolling(true);\n            clearTimeout(state.scrollWatchId);\n            state.scrollWatchId = setTimeout(() => {\n              state.isScrolling(false);\n            }, SCROLL_WATCH_END_TIMER);\n          }\n        },\n        attrs.content || attrs.body || attrs.menu\n      ),\n      attrs.footer\n        ? h(\"div\",\n          {\n            className: classes.footer,\n            key: \"footer\"\n          },\n          attrs.footer\n        )\n        : attrs.footerButtons\n          ? h(\"div\",\n            {\n              className: [\n                classes.footer,\n                classes.footerWithButtons,\n                buttonClasses.row\n              ].join(\" \"),\n              key: \"footer\"\n            },\n            h(\"div\",\n              { className: classes.actions },\n              attrs.footerButtons\n            )\n          )\n          : null\n    ]\n  );\n};\n","import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nexport default {\n  general_styles:                  true,\n\n  border_width:                    1,\n  footer_height:                   52,\n  header_bottom:                   20,\n  header_height:                   60,\n  line_height_title:               24,\n  max_width:                       7 * vars.grid_unit_menu,      // 7 * 56 = 392 \n  min_width:                       5 * vars.grid_unit_menu,      // 5 * 56 = 280\n  padding:                         3 * vars.grid_unit_component, // 3 * 8 = 24\n  side_padding_mobile:             6 * vars.grid_unit,           // 6 * 4 = 48\n\n  color_light_title_text:          \"inherit\",\n  color_light_body_text:           \"inherit\",\n  color_light_body_border:         rgba(vars.color_light_foreground, vars.blend_light_border_light),\n  color_light_background:          \"inherit\",\n\n  color_dark_title_text:           \"inherit\",\n  color_dark_body_text:            \"inherit\",\n  color_dark_body_border:          rgba(vars.color_dark_foreground, vars.blend_dark_border_light),\n  color_dark_background:           \"inherit\",\n};\n"],"names":["component","actions","body","content","footer","header","title","withHeader","withFooter","headerWithTitle","footerWithButtons","footerHigh","borderBottom","borderTop","fullBleed","base","row","focus","label","wash","dropdown","border","disabled","focused","inactive","selected","hasDropdown","highLabel","extraWide","getElement","vnode","attrs","element","SCROLL_WATCH_END_TIMER","updateScrollOverflowState","state","scroller","scrollEl","topOverflow","scrollTop","bottomOverflow","scrollHeight","getBoundingClientRect","height","updateFooterState","footerEl","style","window","getComputedStyle","minHeight","parseInt","classList","add","classes","remove","getInitialState","createStream","headerEl","isScrolling","el","cleanUp","undefined","scrollWatchId","redrawOnUpdate","merge","onMount","dom","querySelector","map","update","unsubscribe","subscribe","onUnMount","createProps","k","keys","unpackAttrs","borders","showTopBorder","showBottomBorder","footerButtons","filterSupportedAttributes","className","tone","class","join","formOptions","createContent","h","renderer","menu","menuContent","key","onscroll","clearTimeout","setTimeout","buttonClasses","rgba","colorStr","opacity","general_styles","border_width","footer_height","header_bottom","header_height","line_height_title","max_width","vars","grid_unit_menu","min_width","padding","grid_unit_component","side_padding_mobile","grid_unit","color_light_title_text","color_light_body_text","color_light_body_border","color_light_foreground","blend_light_border_light","color_light_background","color_dark_title_text","color_dark_body_text","color_dark_body_border","color_dark_foreground","blend_dark_border_light","color_dark_background"],"mappings":"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"}