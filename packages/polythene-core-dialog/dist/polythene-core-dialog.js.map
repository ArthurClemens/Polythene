{"version":3,"file":"polythene-core-dialog.js","sources":["../../polythene-css-classes/list-tile.js","../../polythene-css-classes/menu.js","../../polythene-css-classes/dialog.js","../src/dialog.js"],"sourcesContent":["\nexport default {\n  component:       \"pe-list-tile\",\n\n  // elements\n  content:         \"pe-list-tile__content\",\n  highSubtitle:    \"pe-list-tile__high-subtitle\",\n  primary:         \"pe-list-tile__primary\",\n  secondary:       \"pe-list-tile__secondary\",\n  subtitle:        \"pe-list-tile__subtitle\",\n  title:           \"pe-list-tile__title\",\n  contentFront:    \"pe-list-tile__content-front\",\n\n  // states\n  compact:         \"pe-list-tile--compact\",\n  compactFront:    \"pe-list-tile--compact-front\",\n  disabled:        \"pe-list-tile--disabled\",\n  hasFront:        \"pe-list-tile--front\",\n  hasHighSubtitle: \"pe-list-tile--high-subtitle\",\n  hasSubtitle:     \"pe-list-tile--subtitle\",\n  header:          \"pe-list-tile--header\",\n  hoverable:       \"pe-list-tile--hoverable\",\n  selectable:      \"pe-list-tile--selectable\",\n  selected:        \"pe-list-tile--selected\",\n  highlight:       \"pe-list-tile--highlight\",\n  sticky:          \"pe-list-tile--sticky\",\n  navigation:      \"pe-list-tile--navigation\",\n};\n","import listTileClasses from \"./list-tile\";\n\nexport default {\n  component:   \"pe-menu\",\n\n  // elements\n  panel:       \"pe-menu__panel\",\n  content:     \"pe-menu__content\",\n  placeholder: \"pe-menu__placeholder\",\n  backdrop:    \"pe-menu__backdrop\",\n\n  // states\n  floating:     \"pe-menu--floating\",\n  origin:       \"pe-menu--origin\",\n  permanent:    \"pe-menu--permanent\",\n  showBackdrop: \"pe-menu--backdrop\",\n  visible:      \"pe-menu--visible\",\n  width_auto:   \"pe-menu--width-auto\",\n  width_n:      \"pe-menu--width-\",\n  isTopMenu:    \"pe-menu--top-menu\",\n\n  // lookup\n  listTile:         listTileClasses.component,\n  selectedListTile: listTileClasses.selected,\n};","import menuClasses from \"./menu\";\n\nexport default {\n  component:         \"pe-dialog\",\n\n  // elements\n  placeholder:       \"pe-dialog__placeholder\",\n  holder:            \"pe-dialog__holder\",\n  content:           \"pe-dialog__content\",\n  backdrop:          \"pe-dialog__backdrop\",\n  touch:             \"pe-dialog__touch\",\n\n  // states\n  fullScreen:        \"pe-dialog--full-screen\",\n  open:              \"pe-dialog--open\",    // class set to html element\n  visible:           \"pe-dialog--visible\", // class set to dialog element\n  showBackdrop:      \"pe-dialog--backdrop\",\n  transition:        \"pe-dialog--transition\",\n\n  // lookup\n  menuContent:       menuClasses.content,\n};\n","import { filterSupportedAttributes, subscribe, unsubscribe, transitionComponent } from \"polythene-core\";\nimport classes from \"polythene-css-classes/dialog\";\n\nconst DEFAULT_Z    = 3;\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\nconst transitionOptions = (state, attrs, isShow) => ({\n  state,\n  attrs,\n  isShow,\n  domElements: {\n    el: state.el,\n    contentEl: state.contentEl,\n    backdropEl: state.backdropEl,\n  },\n  showClass: classes.visible,\n  transitionClass: classes.transition,\n});\n\nconst showDialog = (state, attrs) =>\n  transitionComponent(transitionOptions(state, attrs, true));\n\nconst hideDialog = (state, attrs) =>\n  transitionComponent(transitionOptions(state, attrs, false));\n\nexport const getInitialState = (vnode, createStream) => {\n  const transitioning = createStream(false);\n  const visible = createStream(false);\n  return {\n    backdropEl: undefined,\n    touchEl:    undefined,\n    cleanUp:    undefined,\n    el:         undefined,\n    contentEl:  undefined,\n    transitioning,\n    visible,\n    redrawOnUpdate: createStream.merge([transitioning])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const dom = vnode.dom;\n  state.el = dom;\n  state.backdropEl = dom.querySelector(`.${classes.backdrop}`);\n  state.touchEl = dom.querySelector(`.${classes.touch}`);\n  state.contentEl = dom.querySelector(`.${classes.content}`);\n\n  if (!attrs.inactive) {\n\n    const handleEscape = e => {\n      if (attrs.fullScreen || attrs.modal) return;\n      if (e.key === \"Escape\" || e.key === \"Esc\") { // \"Esc\" for IE11\n        const openDialogs = document.querySelectorAll(`.${classes.component}`);\n        if (openDialogs[openDialogs.length - 1] === state.el) {\n          hideDialog(state, Object.assign({}, attrs, {\n            hideDelay: 0\n          }));\n        }\n      }\n    };\n\n    state.cleanUp = () => (\n      unsubscribe(\"keydown\", handleEscape)\n    );\n\n    subscribe(\"keydown\", handleEscape);\n\n    if (attrs.show) {\n      showDialog(state, attrs);\n    }\n  }\n};\n\nexport const onUnMount = vnode => (\n  vnode.state.cleanUp && vnode.state.cleanUp()\n);\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs, { remove: [\"style\"] }), // style set in content, and set by show/hide transition\n    {\n      className: [\n        attrs.parentClassName || classes.component,\n        attrs.fromMultipleClassName,\n        attrs.fullScreen ? classes.fullScreen : null,\n        attrs.backdrop ? classes.showBackdrop : null,\n        // classes.visible is set in showDialog though transition\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \"),\n      \"data-spawn-id\": attrs.spawnId,\n      \"data-instance-id\": attrs.instanceId,\n      // click backdrop: close dialog\n      [k.onclick]: e => {\n        if (e.target !== state.el && e.target !== state.backdropEl && e.target !== state.touchEl) {\n          return;\n        }\n        if (attrs.modal) {\n          // not allowed\n          return;\n        }\n        hideDialog(state, attrs);\n      }\n    }\n  );\n};\n\nexport const createPane = (vnode, { renderer: h, Pane }) => {\n  const attrs = vnode.attrs;\n  return h(Pane, {\n    title: attrs.title,\n    header: attrs.header,\n    body: attrs.content || attrs.body || attrs.menu || vnode.children,\n    footer: attrs.footer,\n    footerButtons: attrs.footerButtons,\n    className: attrs.className,\n    style: attrs.style,\n    fullBleed: attrs.fullBleed,\n    formOptions: attrs.formOptions\n  });\n};\n\nexport const createContent = (vnode, { renderer, Shadow, createPane, Pane }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const h = renderer;\n\n  if (state.el) {\n    const visible = state.visible();\n    const transitioning = state.transitioning();\n    if (!transitioning) {\n      if (attrs.hide && visible) {\n        // Use setTimeout to play nice with React's lifecycle functions\n        setTimeout(() => hideDialog(state, attrs), 0);\n      } else if (attrs.show && !visible) {\n        setTimeout(() => showDialog(state, attrs), 0);\n      }\n    }\n  }\n  const pane = attrs.panesOptions && attrs.panesOptions.length\n    ? h(Pane, attrs.panesOptions[0])\n    : attrs.panes && attrs.panes.length\n      ? attrs.panes[0]\n      : createPane(vnode, { renderer, Pane } );\n  return [\n    h(\"div\",\n      {\n        key: \"backdrop\",\n        className: classes.backdrop\n      }\n    ),\n    h(\"div\",\n      {\n        key: \"touch\",\n        className: classes.touch\n      }\n    ),\n    h(\"div\",\n      {\n        className: [\n          classes.content,\n          attrs.menu ? classes.menuContent : null\n        ].join(\" \"),\n        key: \"content\"\n      },\n      [\n        attrs.fullScreen\n          ? null\n          : h(Shadow, {\n            z: attrs.z !== undefined ? attrs.z : DEFAULT_Z,\n            animated: true,\n            key: \"shadow\"\n          }),\n        pane\n      ]\n    )\n  ];\n};\n"],"names":["component","content","highSubtitle","primary","secondary","subtitle","title","contentFront","compact","compactFront","disabled","hasFront","hasHighSubtitle","hasSubtitle","header","hoverable","selectable","selected","highlight","sticky","navigation","panel","placeholder","backdrop","floating","origin","permanent","showBackdrop","visible","width_auto","width_n","isTopMenu","listTile","listTileClasses","selectedListTile","holder","touch","fullScreen","open","transition","menuContent","menuClasses","DEFAULT_Z","getElement","vnode","attrs","element","transitionOptions","state","isShow","domElements","el","contentEl","backdropEl","showClass","classes","transitionClass","showDialog","transitionComponent","hideDialog","getInitialState","createStream","transitioning","undefined","touchEl","cleanUp","redrawOnUpdate","merge","onMount","dom","querySelector","inactive","handleEscape","modal","e","key","openDialogs","document","querySelectorAll","length","hideDelay","unsubscribe","subscribe","show","onUnMount","createProps","k","keys","filterSupportedAttributes","remove","className","parentClassName","fromMultipleClassName","tone","class","join","spawnId","instanceId","onclick","target","createPane","h","renderer","Pane","body","menu","children","footer","footerButtons","style","fullBleed","formOptions","createContent","Shadow","hide","setTimeout","pane","panesOptions","panes","z","animated"],"mappings":"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"}