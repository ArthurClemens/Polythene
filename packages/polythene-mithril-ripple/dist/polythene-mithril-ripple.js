!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("mithril")):"function"==typeof define&&define.amd?define(["exports","mithril"],t):t(e.polythene={},e.m)}(this,function(e,t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;const n={autocomplete:"autocomplete",autofocus:"autofocus",class:"class",className:"class",enctype:"enctype",formaction:"formaction",frameborder:"frameborder",maxlength:"maxlength",minlength:"minlength",onblur:"onblur",onchange:"onchange",onclick:"onclick",onfocus:"onfocus",oninput:"oninput",onkeydown:"onkeydown",onkeyup:"onkeyup",onmousedown:"onmousedown",onmouseout:"onmouseout",onmouseover:"onmouseover",onmouseup:"onmouseup",onscroll:"onscroll",onsubmit:"onsubmit",ontouchend:"ontouchend",ontouchmove:"ontouchmove",ontouchstart:"ontouchstart",readonly:"readonly",tabindex:"tabindex"},a=t;a.displayName="mithril";var o,r=(function(e){!function(){var t=0,n={};function a(){function e(){return arguments.length>0&&arguments[0]!==n&&o(e,arguments[0]),e._state.value}return function(e){e.constructor=a,e._state={id:t++,value:void 0,state:0,derive:void 0,recover:void 0,deps:{},parents:[],endStream:void 0,unregister:void 0},e.map=e["fantasy-land/map"]=u,e["fantasy-land/ap"]=d,e["fantasy-land/of"]=a,e.valueOf=l,e.toJSON=m,e.toString=l,Object.defineProperties(e,{end:{get:function(){if(!e._state.endStream){var t=a();t.map(function(n){return!0===n&&(c(e),t._state.unregister=function(){c(t)}),n}),e._state.endStream=t}return e._state.endStream}}})}(e),arguments.length>0&&arguments[0]!==n&&o(e,arguments[0]),e}function o(e,t){for(var n in r(e,t),e._state.deps)i(e._state.deps[n],!1);null!=e._state.unregister&&e._state.unregister(),function(e){for(var t in e._state.changed=!1,e._state.deps)e._state.deps[t]._state.changed=!1}(e)}function r(e,t){e._state.value=t,e._state.changed=!0,2!==e._state.state&&(e._state.state=1)}function i(e,t){var a=e._state.parents;if(a.length>0&&a.every(f)&&(t||a.some(v))){var o=e._state.derive();if(o===n)return!1;r(e,o)}}function s(e,t){if(!t.every(p))throw new Error("Ensure that each item passed to stream.combine/stream.merge is a stream");return function(e,t,n){var a=e._state;return a.derive=n,a.parents=t.filter(h),function e(t,n){for(var a=0;a<n.length;a++)n[a]._state.deps[t._state.id]=t,e(t,n[a]._state.parents)}(e,a.parents),i(e,!0),e}(a(),t,function(){return e.apply(this,t.concat([t.filter(v)]))})}function c(e){for(var t=0;t<e._state.parents.length;t++){delete e._state.parents[t]._state.deps[e._state.id]}for(var n in e._state.deps){var a=e._state.deps[n],o=a._state.parents.indexOf(e);o>-1&&a._state.parents.splice(o,1)}e._state.state=2,e._state.deps={}}function u(e){return s(function(t){return e(t())},[this])}function d(e){return s(function(e,t){return e()(t())},[e,this])}function l(){return this._state.value}function m(){return null!=this._state.value&&"function"==typeof this._state.value.toJSON?this._state.value.toJSON():this._state.value}function p(e){return e._state}function f(e){return 1===e._state.state}function v(e){return e._state.changed}function h(e){return 2!==e._state.state}a["fantasy-land/of"]=a,a.merge=function(e){return s(function(){return e.map(function(e){return e()})},e)},a.combine=s,a.scan=function(e,t,n){var a=s(function(n){return t=e(t,n._state.value)},[n]);return 0===a._state.state&&a(t),a},a.scanMerge=function(e,t){var n=e.map(function(e){var t=e[0];return 0===t._state.state&&t(void 0),t});return s(function(){var a=arguments[arguments.length-1];return n.forEach(function(n,o){a.indexOf(n)>-1&&(t=e[o][1](t,n._state.value))}),t},n)},a.HALT=n,e.exports=a}()}(o={exports:{}},o.exports),o.exports);const i="undefined"!=typeof document,s=!i,c={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"},u=(e,t)=>(e[t]=1,e),d=["key","style","href","id","tabIndex","tabindex","oninit","oncreate","onupdate","onbeforeremove","onremove","onbeforeupdate"],l=!s&&"ontouchstart"in document.documentElement,m=l?["click","mouseup"]:["mouseup"];i&&document.querySelector("html").classList.add(l?"pe-touch":"pe-no-touch");const p={},f=(e,t)=>{p[e]&&p[e].forEach(e=>e(t))};i&&(window.addEventListener("resize",e=>f("resize",e)),window.addEventListener("scroll",e=>f("scroll",e)),window.addEventListener("keydown",e=>f("keydown",e)),window.addEventListener(m,e=>f(m,e)));const v="ease-out",h=(()=>{if(i){const e=document.createElement("fakeelement");for(let t in c)if(void 0!==e.style[t])return c[t]}})();var _=({e:e,id:t,el:n,attrs:a,classes:o})=>new Promise(r=>{const i=document.createElement("div");i.setAttribute("class",o.mask),n.appendChild(i);const c=document.createElement("div");c.setAttribute("class",o.waves),i.appendChild(c);const u=n.getBoundingClientRect(),d=l&&e.touches?e.touches[0].pageX:e.clientX,m=l&&e.touches?e.touches[0].pageY:e.clientY,p=n.offsetWidth,f=n.offsetHeight,_=Math.sqrt(p*p+f*f),y=a.center?u.left+u.width/2:d,g=a.center?u.top+u.height/2:m,w=y-u.left-_/2,b=g-u.top-_/2,k=void 0!==a.startOpacity?a.startOpacity:.2,E=void 0!==a.opacityDecayVelocity?a.opacityDecayVelocity:.35,O=a.endOpacity||0,x=a.startScale||.1,S=a.endScale||2,A=a.duration?a.duration:1/E*.2,L=window.getComputedStyle(n).color,N=c.style;N.width=N.height=_+"px",N.top=b+"px",N.left=w+"px",N["animation-duration"]=N["-webkit-animation-duration"]=N["-moz-animation-duration"]=N["-o-animation-duration"]=A+"s",N.backgroundColor=L,N.opacity=k,N.animationName=t,N.animationTimingFunction=a.animationTimingFunction||v,((e,t)=>{if(s)return;const n=window.document,a=n.createElement("style");a.setAttribute("id",e),a.appendChild(n.createTextNode(t)),n.head.appendChild(a)})(t,`@keyframes ${t} {\n      0% {\n        transform:scale(${x});\n        opacity: ${k}\n      }\n      100% {\n        transform:scale(${S});\n        opacity: ${O};\n      }\n    }`);const C=e=>{(e=>{if(s)return;const t=document.getElementById(e);t&&t.parentNode&&t.parentNode.removeChild(t)})(t),c.removeEventListener(h,C,!1),a.persistent?(N.opacity=O,N.transform="scale("+S+")"):(c.classList.remove(o.wavesAnimating),i.removeChild(c),n.removeChild(i)),r(e)};c.addEventListener(h,C,!1),c.classList.add(o.wavesAnimating)}),y={component:"pe-ripple",mask:"pe-ripple__mask",waves:"pe-ripple__waves",unconstrained:"pe-ripple--unconstrained",wavesAnimating:"pe-ripple__waves--animating"};const g=e=>e.animating=Object.keys(e.animations).length>0;const w=(({createContent:e=(()=>{}),createProps:t=(()=>{}),component:o=null,getElement:i=(()=>"div"),getInitialState:s=(()=>({})),onMount:c=(()=>{}),onUnMount:u=(()=>{}),onUpdate:d=(()=>{}),view:l=null})=>{const m=r=>a(o||i(r),t(r,{renderer:a,requiresKeys:!1,keys:n}),[r.attrs.before,e(r,{renderer:a,requiresKeys:!1,keys:n}),r.attrs.after]);return{view:l?e=>l(e,{render:m,renderer:a}):e=>m(e),oninit:e=>{const t=Object.assign({},e),o=s(t,r,{keys:n});Object.assign(e.state,o),e._mounted=!1,e.state.redrawOnUpdate&&e.state.redrawOnUpdate.map(()=>e._mounted&&setTimeout(a.redraw(!0)))},oncreate:e=>{e._mounted=!0,c(e,{keys:n})},onremove:u,onupdate:d}})(Object.freeze({getElement:e=>e.attrs.element||"div",getInitialState:()=>({animations:{},animating:!1,cleanUp:void 0}),createProps:(e,{keys:t})=>{const n=e.attrs;return Object.assign({},((e,{add:t=[],remove:n=[]}={})=>{const a=n.reduce(u,{}),o=d.concat(t).filter(e=>!a[e]).reduce(u,{});return Object.keys(e).reduce((t,n)=>(o[n]&&(t[n]=e[n]),t),{})})(n),{className:[y.component,n.unconstrained?y.unconstrained:null,"dark"===n.tone?"pe-dark-tone":null,"light"===n.tone?"pe-light-tone":null,n.className||n[t.class]].join(" ")})},onMount:e=>{if(!e.dom)return;if(s)return;const t=e.state,n=e.attrs,a=a=>{if(n.disabled||!n.multi&&t.animating)return;n.start&&n.start(a);const o=`ripple_animation_${(new Date).getTime()}`;t.animations[o]=_({e:a,id:o,el:e.dom,attrs:n,classes:y}).then(e=>{n.end&&n.end(e),delete t.animations[o],g(t)}),g(t)},o=n.target?n.target:e.dom&&e.dom.parentElement;o&&m.forEach(e=>o.addEventListener(e,a,!1)),t.cleanUp=(()=>{o&&m.forEach(e=>o.removeEventListener(e,a,!1))})},onUnMount:({state:e})=>e.cleanUp&&e.cleanUp()}));w.displayName="Ripple",e.Ripple=w,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-mithril-ripple.js.map
