{"version":3,"file":"polythene-react-base.js","sources":["../src/keys.js","../src/MithrilToReact.js","../src/renderer.js","../node_modules/mithril/stream/stream.js","../node_modules/mithril/stream.js","../src/StateComponent.js","../src/ViewComponent.js"],"sourcesContent":["\nexport const keys = {\n  autocomplete: \"autoComplete\",\n  autofocus:    \"autoFocus\",\n  class:        \"className\",\n  className:    \"className\",\n  enctype:      \"encType\",\n  formaction:   \"formAction\",\n  frameborder:  \"frameBorder\",\n  maxlength:    \"maxLength\",\n  minlength:    \"minLength\",\n  onblur:       \"onBlur\",\n  onchange:     \"onChange\",\n  onclick:      \"onClick\",\n  onfocus:      \"onFocus\",\n  oninput:      \"onInput\",\n  onkeydown:    \"onKeyDown\",\n  onkeyup:      \"onKeyUp\",\n  onmousedown:  \"onMouseDown\",\n  onmouseout:   \"onMouseOut\",\n  onmouseover:  \"onMouseOver\",\n  onmouseup:    \"onMouseUp\",\n  onscroll:     \"onScroll\",\n  onsubmit:     \"onSubmit\",\n  ontouchend:   \"onTouchEnd\",\n  ontouchmove:  \"onTouchMove\",\n  ontouchstart: \"onTouchStart\",\n  readonly:     \"readOnly\",\n  tabindex:     \"tabIndex\",\n};\n\nexport const normalizeKey = key => keys[key.toLowerCase()];\n","/*\nTakes a Mithril component object and returns a React component (for keys oninit and view).\nAutomatically redraws when the stream `vnode.state.redrawOnUpdate` exists, and the stream is updated.\n\nExample: \n\nimport stream from \"mithril/stream\";\nimport { renderer as h, Button } from \"polythene-react\";\n\nconst StateComponent = {\n  oninit: vnode => {\n    const checked = stream(false);\n    Object.assign(vnode.state, {\n      checked,\n      redrawOnUpdate: stream.merge([checked])\n    });\n  },\n  view: vnode => {\n    const state = vnode.state;\n    const attrs = vnode.attrs;\n    const checked = state.checked();\n    return h(Button, {\n      raised: true,\n      label: `Click ${attrs.subject} to switch ${checked ? \"Off\" : \"On\"}`,\n      events: {\n        [keys.onclick]: () => state.checked(!checked)\n      }\n    });\n  }\n};\n\nh(StateComponent, { subject: \"airco\"});\n*/\n\nimport React from \"react\";\n\nexport const MithrilToReact = component => (\n\n  class extends React.Component {\n\n    constructor(props) {\n      super(props);\n      const vnode = Object.assign(\n        {},\n        component,\n        {\n          state: {},\n          attrs: this.props,\n          redrawValues: undefined\n        }\n      );\n      if (component.oninit) {\n        component.oninit(vnode);\n      }\n      this.state = vnode;\n    }\n\n    componentDidMount() {\n      this._mounted = true;\n      this.state.state.redrawOnUpdate && this.state.state.redrawOnUpdate.map(values => {\n        if (this._mounted) {\n          this.setState({ redrawValues: values });\n        }\n      });\n    }\n\n    componentWillUnmount() {\n      this._mounted = false;\n    }\n\n    render() {\n      return component.view({ state: this.state.state, attrs: this.props }, this.props.children);\n    }\n  }\n);\n","import h from \"react-hyperscript\";\nimport { MithrilToReact } from \"./MithrilToReact\";\n\nexport const renderer = (...args) =>\n  typeof args[0] === \"object\"\n    ? h.call(null, MithrilToReact(args[0]), ...args.slice(1))\n    : h.call(null, ...args);\n\nrenderer.trust = (html, element = \"div\") => {\n  if (html == null) html = \"\";\n  return h(element, {\n    dangerouslySetInnerHTML: { __html: html }\n  });\n};\n\nrenderer.displayName = \"react\";","/* eslint-disable */\n;(function() {\n\"use strict\"\n/* eslint-enable */\n\nvar guid = 0, HALT = {}\nfunction createStream() {\n\tfunction stream() {\n\t\tif (arguments.length > 0 && arguments[0] !== HALT) updateStream(stream, arguments[0])\n\t\treturn stream._state.value\n\t}\n\tinitStream(stream)\n\n\tif (arguments.length > 0 && arguments[0] !== HALT) updateStream(stream, arguments[0])\n\n\treturn stream\n}\nfunction initStream(stream) {\n\tstream.constructor = createStream\n\tstream._state = {id: guid++, value: undefined, state: 0, derive: undefined, recover: undefined, deps: {}, parents: [], endStream: undefined, unregister: undefined}\n\tstream.map = stream[\"fantasy-land/map\"] = map, stream[\"fantasy-land/ap\"] = ap, stream[\"fantasy-land/of\"] = createStream\n\tstream.valueOf = valueOf, stream.toJSON = toJSON, stream.toString = valueOf\n\n\tObject.defineProperties(stream, {\n\t\tend: {get: function() {\n\t\t\tif (!stream._state.endStream) {\n\t\t\t\tvar endStream = createStream()\n\t\t\t\tendStream.map(function(value) {\n\t\t\t\t\tif (value === true) {\n\t\t\t\t\t\tunregisterStream(stream)\n\t\t\t\t\t\tendStream._state.unregister = function(){unregisterStream(endStream)}\n\t\t\t\t\t}\n\t\t\t\t\treturn value\n\t\t\t\t})\n\t\t\t\tstream._state.endStream = endStream\n\t\t\t}\n\t\t\treturn stream._state.endStream\n\t\t}}\n\t})\n}\nfunction updateStream(stream, value) {\n\tupdateState(stream, value)\n\tfor (var id in stream._state.deps) updateDependency(stream._state.deps[id], false)\n\tif (stream._state.unregister != null) stream._state.unregister()\n\tfinalize(stream)\n}\nfunction updateState(stream, value) {\n\tstream._state.value = value\n\tstream._state.changed = true\n\tif (stream._state.state !== 2) stream._state.state = 1\n}\nfunction updateDependency(stream, mustSync) {\n\tvar state = stream._state, parents = state.parents\n\tif (parents.length > 0 && parents.every(active) && (mustSync || parents.some(changed))) {\n\t\tvar value = stream._state.derive()\n\t\tif (value === HALT) return false\n\t\tupdateState(stream, value)\n\t}\n}\nfunction finalize(stream) {\n\tstream._state.changed = false\n\tfor (var id in stream._state.deps) stream._state.deps[id]._state.changed = false\n}\n\nfunction combine(fn, streams) {\n\tif (!streams.every(valid)) throw new Error(\"Ensure that each item passed to stream.combine/stream.merge is a stream\")\n\treturn initDependency(createStream(), streams, function() {\n\t\treturn fn.apply(this, streams.concat([streams.filter(changed)]))\n\t})\n}\n\nfunction initDependency(dep, streams, derive) {\n\tvar state = dep._state\n\tstate.derive = derive\n\tstate.parents = streams.filter(notEnded)\n\n\tregisterDependency(dep, state.parents)\n\tupdateDependency(dep, true)\n\n\treturn dep\n}\nfunction registerDependency(stream, parents) {\n\tfor (var i = 0; i < parents.length; i++) {\n\t\tparents[i]._state.deps[stream._state.id] = stream\n\t\tregisterDependency(stream, parents[i]._state.parents)\n\t}\n}\nfunction unregisterStream(stream) {\n\tfor (var i = 0; i < stream._state.parents.length; i++) {\n\t\tvar parent = stream._state.parents[i]\n\t\tdelete parent._state.deps[stream._state.id]\n\t}\n\tfor (var id in stream._state.deps) {\n\t\tvar dependent = stream._state.deps[id]\n\t\tvar index = dependent._state.parents.indexOf(stream)\n\t\tif (index > -1) dependent._state.parents.splice(index, 1)\n\t}\n\tstream._state.state = 2 //ended\n\tstream._state.deps = {}\n}\n\nfunction map(fn) {return combine(function(stream) {return fn(stream())}, [this])}\nfunction ap(stream) {return combine(function(s1, s2) {return s1()(s2())}, [stream, this])}\nfunction valueOf() {return this._state.value}\nfunction toJSON() {return this._state.value != null && typeof this._state.value.toJSON === \"function\" ? this._state.value.toJSON() : this._state.value}\n\nfunction valid(stream) {return stream._state }\nfunction active(stream) {return stream._state.state === 1}\nfunction changed(stream) {return stream._state.changed}\nfunction notEnded(stream) {return stream._state.state !== 2}\n\nfunction merge(streams) {\n\treturn combine(function() {\n\t\treturn streams.map(function(s) {return s()})\n\t}, streams)\n}\n\nfunction scan(reducer, seed, stream) {\n\tvar newStream = combine(function (s) {\n\t\treturn seed = reducer(seed, s._state.value)\n\t}, [stream])\n\n\tif (newStream._state.state === 0) newStream(seed)\n\n\treturn newStream\n}\n\nfunction scanMerge(tuples, seed) {\n\tvar streams = tuples.map(function(tuple) {\n\t\tvar stream = tuple[0]\n\t\tif (stream._state.state === 0) stream(undefined)\n\t\treturn stream\n\t})\n\n\tvar newStream = combine(function() {\n\t\tvar changed = arguments[arguments.length - 1]\n\n\t\tstreams.forEach(function(stream, idx) {\n\t\t\tif (changed.indexOf(stream) > -1) {\n\t\t\t\tseed = tuples[idx][1](seed, stream._state.value)\n\t\t\t}\n\t\t})\n\n\t\treturn seed\n\t}, streams)\n\n\treturn newStream\n}\n\ncreateStream[\"fantasy-land/of\"] = createStream\ncreateStream.merge = merge\ncreateStream.combine = combine\ncreateStream.scan = scan\ncreateStream.scanMerge = scanMerge\ncreateStream.HALT = HALT\n\nif (typeof module !== \"undefined\") module[\"exports\"] = createStream\nelse if (typeof window.m === \"function\" && !(\"stream\" in window.m)) window.m.stream = createStream\nelse window.m = {stream : createStream}\n\n}());\n","\"use strict\"\n\nmodule.exports = require(\"./stream/stream\")\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport stream from \"mithril/stream\";\nimport { renderer } from \"./renderer\";\nimport { keys } from \"./keys\";\nimport { isClient } from \"polythene-core\";\n\nconst requiresKeys = true;\n\nexport const StateComponent = ({\n  createContent = () => {},\n  createProps = () => ({}),\n  getElement = () => \"div\",\n  component,\n  getInitialState = () => ({}),\n  onMount = () => {},\n  onUnMount = () => {},\n  onUpdate = () => {},\n  view = null\n}) => {\n  \n  return class extends React.Component {\n    \n    constructor(props) {\n      super(props);\n      this.dom = null;\n      const protoState = Object.assign(\n        {},\n        component,\n        this.createVirtualNode(),\n        {\n          redrawValues: undefined\n        }\n      );\n      this.state = getInitialState(protoState, stream, { keys });\n      this.registerDOM = this.registerDOM.bind(this);\n      this._render = this._render.bind(this);      \n    }\n    \n    componentDidMount() {\n      this._mounted = true;\n      this.state.redrawOnUpdate && this.state.redrawOnUpdate.map(values => (\n        setTimeout(() => this._mounted && this.setState({ redrawValues: values }), 0)\n      ));\n      onMount(this.createVirtualNode(), { keys });\n    }\n\n    componentDidUpdate() {\n      onUpdate(this.createVirtualNode());\n    }\n\n    componentWillUnmount() {\n      this._mounted = false;\n      onUnMount(this.createVirtualNode());\n    }\n\n    createVirtualNode() {\n      return {\n        state: this.state,\n        attrs: this.props,\n        children: this.props.children,\n        dom: this.dom,\n      };\n    }\n\n    registerDOM(el) {\n      if (isClient && !this.dom && el) {\n        this.dom = el instanceof HTMLElement\n          ? el\n          : ReactDOM.findDOMNode(el);\n      }\n    }\n\n    _render() {\n      const vnode = this.createVirtualNode();\n      return renderer(\n        component || getElement(vnode),\n        Object.assign(\n          {},\n          createProps(vnode, { renderer, requiresKeys, keys }),\n          { ref: this.registerDOM }\n        ),\n        [\n          vnode.attrs.before,\n          createContent(vnode, { renderer, requiresKeys, keys }),\n          vnode.attrs.after\n        ]\n      );\n    }\n\n    render() {\n      return view\n        ? view(this.createVirtualNode(), { renderer, render: this._render })\n        : this._render(this.props);\n    }\n  };\n};","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { renderer } from \"./renderer\";\nimport { keys } from \"./keys\";\nimport { isClient } from \"polythene-core\";\n\nconst requiresKeys = true;\n\nexport const ViewComponent = ({\n  createContent = () => {},\n  createProps = () => ({}),\n  getElement = () => \"div\",\n  onMount = () => {},\n  onUnMount = () => {},\n  component,\n  view = null\n}) => {\n  \n  return class extends React.Component {\n\n    constructor(props) {\n      super(props);\n      this.dom = null;\n      this.registerDOM = this.registerDOM.bind(this);\n      this._render = this._render.bind(this);\n    }\n\n    componentDidMount() {\n      onMount(this.createVirtualNode(), { keys });\n    }\n\n    componentWillUnmount() {\n      onUnMount(this.createVirtualNode());\n    }\n\n    createVirtualNode() {\n      const props = Object.assign({}, this.props);\n      return {\n        attrs: props,\n        children: props.children,\n        dom: this.dom\n      };\n    }\n\n    registerDOM(el) {\n      if (isClient && !this.dom && el) {\n        this.dom = el instanceof HTMLElement\n          ? el\n          : ReactDOM.findDOMNode(el);\n      }\n    }\n\n    _render() {\n      const vnode = this.createVirtualNode();\n      return renderer(\n        component || getElement(vnode),\n        Object.assign(\n          {},\n          createProps(vnode, { renderer, requiresKeys, keys }),\n          { ref: this.registerDOM }\n        ),\n        [\n          vnode.attrs.before,\n          createContent(vnode, { renderer, requiresKeys, keys }),\n          vnode.attrs.after\n        ]\n      );\n    }\n\n    render() {\n      return view\n        ? view(this.createVirtualNode(), { renderer, render: this._render })\n        : this._render(this.props);\n    }\n  };\n};\n"],"names":["keys","autocomplete","autofocus","class","className","enctype","formaction","frameborder","maxlength","minlength","onblur","onchange","onclick","onfocus","oninput","onkeydown","onkeyup","onmousedown","onmouseout","onmouseover","onmouseup","onscroll","onsubmit","ontouchend","ontouchmove","ontouchstart","readonly","tabindex","MithrilToReact","props","vnode","component","state","attrs","redrawValues","undefined","oninit","_mounted","redrawOnUpdate","map","setState","values","view","children","React","Component","renderer","args","h","call","slice","trust","html","element","dangerouslySetInnerHTML","__html","displayName","guid","HALT","createStream","stream","arguments","length","updateStream","_state","value","initStream","constructor","id","derive","recover","deps","parents","endStream","unregister","ap","valueOf","toJSON","toString","Object","defineProperties","end","get","unregisterStream","updateState","updateDependency","finalize","changed","mustSync","every","active","some","combine","fn","streams","valid","Error","initDependency","apply","concat","filter","dep","notEnded","registerDependency","i","parent","dependent","index","indexOf","splice","s1","s2","merge","s","scan","reducer","seed","newStream","scanMerge","tuples","tuple","forEach","idx","module","require$$0","requiresKeys","StateComponent","createContent","createProps","getElement","getInitialState","onMount","onUnMount","onUpdate","dom","protoState","_extends","createVirtualNode","registerDOM","bind","_render","setTimeout","el","isClient","HTMLElement","ReactDOM","findDOMNode","ref","before","after","render","ViewComponent"],"mappings":"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"}