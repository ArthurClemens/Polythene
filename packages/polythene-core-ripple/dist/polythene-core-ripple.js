!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("polythene-core"),require("polythene-theme")):"function"==typeof define&&define.amd?define(["exports","polythene-core","polythene-theme"],t):t((e=e||self).polythene={},e["polythene-core"],e["polythene-theme"])}(this,function(e,t,n){"use strict";const i=t.getAnimationEndEvent();var a=({e:e,id:a,el:o,attrs:r,classes:s})=>new Promise(c=>{const d=document.createElement("div");d.setAttribute("class",s.mask),o.appendChild(d);const l=document.createElement("div");l.setAttribute("class",s.waves),d.appendChild(l);const p=o.getBoundingClientRect(),m=t.isTouch&&e.touches?e.touches[0].pageX:e.clientX,u=t.isTouch&&e.touches?e.touches[0].pageY:e.clientY,h=o.offsetWidth,v=o.offsetHeight,f=Math.sqrt(h*h+v*v),y=r.center?p.left+p.width/2:m,g=r.center?p.top+p.height/2:u,E=y-p.left-f/2,w=g-p.top-f/2,b=void 0!==r.startOpacity?r.startOpacity:.2,_=void 0!==r.opacityDecayVelocity?r.opacityDecayVelocity:.35,k=r.endOpacity||0,C=r.startScale||.1,A=r.endScale||2,S=r.duration?r.duration:1/_*.2,x=window.getComputedStyle(o).color,O=l.style;O.width=O.height=f+"px",O.top=w+"px",O.left=E+"px",O["animation-duration"]=O["-webkit-animation-duration"]=O["-moz-animation-duration"]=O["-o-animation-duration"]=S+"s",O.backgroundColor=x,O.opacity=b,O.animationName=a,O.animationTimingFunction=r.animationTimingFunction||n.vars.animation_curve_default,((e,n)=>{if(t.isServer)return;const i=window.document,a=i.createElement("style");a.setAttribute("id",e),a.appendChild(i.createTextNode(n)),i.head.appendChild(a)})(a,`@keyframes ${a} {\n      0% {\n        transform:scale(${C});\n        opacity: ${b}\n      }\n      100% {\n        transform:scale(${A});\n        opacity: ${k};\n      }\n    }`);const j=e=>{(e=>{if(t.isServer)return;const n=document.getElementById(e);n&&n.parentNode&&n.parentNode.removeChild(n)})(a),l.removeEventListener(i,j,!1),r.persistent?(O.opacity=k,O.transform="scale("+A+")"):(l.classList.remove(s.wavesAnimating),d.removeChild(l),o.removeChild(d)),c(e)};l.addEventListener(i,j,!1),l.classList.add(s.wavesAnimating)}),o={component:"pe-ripple",mask:"pe-ripple__mask",waves:"pe-ripple__waves",unconstrained:"pe-ripple--unconstrained",wavesAnimating:"pe-ripple__waves--animating"};const r=e=>e.animating=Object.keys(e.animations).length>0;var s=Object.freeze({getElement:e=>e.attrs.element||"div",getInitialState:()=>({animations:{},animating:!1,cleanUp:void 0}),createProps:(e,{keys:n})=>{const i=e.attrs;return Object.assign({},t.filterSupportedAttributes(i),{className:[o.component,i.unconstrained?o.unconstrained:null,"dark"===i.tone?"pe-dark-tone":null,"light"===i.tone?"pe-light-tone":null,i.className||i[n.class]].join(" ")})},onMount:e=>{if(!e.dom)return;if(t.isServer)return;const n=e.state,i=e.attrs,s=t=>{if(i.disabled||!i.multi&&n.animating)return;i.start&&i.start(t);const s=`ripple_animation_${(new Date).getTime()}`;n.animations[s]=a({e:t,id:s,el:e.dom,attrs:i,classes:o}).then(e=>{i.end&&i.end(e),delete n.animations[s],r(n)}),r(n)},c=i.target?i.target:e.dom&&e.dom.parentElement;c&&t.pointerEndEvent.forEach(e=>c.addEventListener(e,s,!1)),n.cleanUp=(()=>{c&&t.pointerEndEvent.forEach(e=>c.removeEventListener(e,s,!1))})},onUnMount:({state:e})=>e.cleanUp&&e.cleanUp()});e.coreRipple=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-core-ripple.js.map
