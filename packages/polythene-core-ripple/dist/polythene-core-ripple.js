!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("polythene-core"),require("polythene-theme")):"function"==typeof define&&define.amd?define(["exports","polythene-core","polythene-theme"],t):t((e=e||self).polythene={},e["polythene-core"],e["polythene-theme"])}(this,function(e,t,n){"use strict";function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}var a=t.getAnimationEndEvent(),o=function(e){var i=e.e,o=e.id,r=e.el,c=e.attrs,s=e.classes;return new Promise(function(e){var l=document.createElement("div");l.setAttribute("class",s.mask),r.appendChild(l);var p=document.createElement("div");p.setAttribute("class",s.waves),l.appendChild(p);var d=r.getBoundingClientRect(),u=t.isTouch&&i.touches?i.touches[0].pageX:i.clientX,m=t.isTouch&&i.touches?i.touches[0].pageY:i.clientY,f=r.offsetWidth,v=r.offsetHeight,h=Math.sqrt(f*f+v*v),y=c.center?d.left+d.width/2:u,g=c.center?d.top+d.height/2:m,E=y-d.left-h/2,w=g-d.top-h/2,b=void 0!==c.startOpacity?c.startOpacity:.2,_=void 0!==c.opacityDecayVelocity?c.opacityDecayVelocity:.35,k=c.endOpacity||0,C=c.startScale||.1,O=c.endScale||2,A=c.duration?c.duration:1/_*.2,S=window.getComputedStyle(r).color,j=p.style;j.width=j.height=h+"px",j.top=w+"px",j.left=E+"px",j["animation-duration"]=j["-webkit-animation-duration"]=j["-moz-animation-duration"]=j["-o-animation-duration"]=A+"s",j.backgroundColor=S,j.opacity=b,j.animationName=o,j.animationTimingFunction=c.animationTimingFunction||n.vars.animation_curve_default;var x="@keyframes ".concat(o," {\n      0% {\n        transform:scale(").concat(C,");\n        opacity: ").concat(b,"\n      }\n      100% {\n        transform:scale(").concat(O,");\n        opacity: ").concat(k,";\n      }\n    }");!function(e,n){if(!t.isServer){var i=window.document,a=i.createElement("style");a.setAttribute("id",e),a.appendChild(i.createTextNode(n)),i.head.appendChild(a)}}(o,x);p.addEventListener(a,function n(i){!function(e){if(!t.isServer){var n=document.getElementById(e);n&&n.parentNode&&n.parentNode.removeChild(n)}}(o),p.removeEventListener(a,n,!1),c.persistent?(j.opacity=k,j.transform="scale("+O+")"):(p.classList.remove(s.wavesAnimating),l.removeChild(p),r.removeChild(l)),e(i)},!1),p.classList.add(s.wavesAnimating)})},r={component:"pe-ripple",mask:"pe-ripple__mask",waves:"pe-ripple__waves",unconstrained:"pe-ripple--unconstrained",wavesAnimating:"pe-ripple__waves--animating"},c=function(e){return e.animating=Object.keys(e.animations).length>0},s=Object.freeze({getElement:function(e){return e.attrs.element||"div"},getInitialState:function(){return{animations:{},animating:!1,cleanUp:void 0}},createProps:function(e,n){var a=n.keys,o=e.attrs;return i({},t.filterSupportedAttributes(o),{className:[r.component,o.unconstrained?r.unconstrained:null,"dark"===o.tone?"pe-dark-tone":null,"light"===o.tone?"pe-light-tone":null,o.className||o[a.class]].join(" ")})},onMount:function(e){if(e.dom&&!t.isServer){var n=e.state,i=e.attrs,a=function(t){if(!(i.disabled||!i.multi&&n.animating)){i.start&&i.start(t);var a="ripple_animation_".concat((new Date).getTime());n.animations[a]=o({e:t,id:a,el:e.dom,attrs:i,classes:r}).then(function(e){i.end&&i.end(e),delete n.animations[a],c(n)}),c(n)}},s=i.target?i.target:e.dom&&e.dom.parentElement;s&&t.pointerEndEvent.forEach(function(e){return s.addEventListener(e,a,!1)}),n.cleanUp=function(){s&&t.pointerEndEvent.forEach(function(e){return s.removeEventListener(e,a,!1)})}}},onUnMount:function(e){var t=e.state;return t.cleanUp&&t.cleanUp()}});e.coreRipple=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-core-ripple.js.map
