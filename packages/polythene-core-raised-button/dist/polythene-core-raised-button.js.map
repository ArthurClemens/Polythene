{"version":3,"file":"polythene-core-raised-button.js","sources":["../../polythene-css-classes/raised-button.js","../src/raised-button.js"],"sourcesContent":["\nexport default {\n  component: \"pe-button pe-text-button pe-raised-button\"\n};\n","import { isServer, pointerStartMoveEvent, pointerEndMoveEvent } from \"polythene-core\";\nimport classes from \"polythene-css-classes/raised-button\";\n\n// Don't export 'getElement': it will be the wrapped button component (set in polythene-xxx-raised-button)\n\nconst MAX_Z = 5;\n\nlet tapStart,\n  tapEndAll = () => {},\n  downButtons = [];\n\nconst animateZ = (which, vnode) => {\n  const zBase = vnode.state.zBase;\n  const increase = vnode.attrs.increase || 1;\n  const z = vnode.state.z();\n  const newZ = which === \"down\" && zBase < MAX_Z\n    ? Math.min(zBase + increase, MAX_Z)\n    : which === \"up\"\n      ? Math.max(z - increase, zBase)\n      : z;\n  if (newZ !== z) {\n    vnode.state.z(newZ);\n  }\n};\n\nconst tapHandler = (which, vnode) => {\n  if (which === \"down\") {\n    downButtons.push(Object.assign({}, vnode));\n  }\n  const animateOnTap = vnode.attrs.animateOnTap !== false ? true : false;\n  if (animateOnTap) {\n    animateZ(which, vnode);\n  }\n};\n\nconst initTapEvents = vnode => {\n  if (isServer) return;\n  tapStart = () => tapHandler(\"down\", vnode);\n  tapEndAll = () => {\n    downButtons.map(buttonVnode =>\n      tapHandler(\"up\", buttonVnode));\n    downButtons = [];\n  };\n  pointerStartMoveEvent.forEach(evt =>\n    vnode.dom.addEventListener(evt, tapStart));\n  pointerEndMoveEvent.forEach(evt =>\n    document.addEventListener(evt, tapEndAll));\n};\n\nconst clearTapEvents = vnode => {\n  pointerStartMoveEvent.forEach(evt =>\n    vnode.dom.removeEventListener(evt, tapStart));\n  pointerEndMoveEvent.forEach(evt =>\n    document.removeEventListener(evt, tapEndAll));\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n  const zBase = attrs.z !== undefined ? attrs.z : 1;\n  const z = createStream(zBase);\n  const tapEventsInited = createStream(false);\n  return {\n    zBase,\n    z,\n    tapEventsInited,\n    redrawOnUpdate: createStream.merge([z])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  if (!state.tapEventsInited()) {\n    initTapEvents(vnode);\n    state.tapEventsInited(true);\n  }\n};\n\nexport const onUnMount = vnode => {\n  if (vnode.state.tapEventsInited()) {\n    clearTapEvents(vnode);\n  }\n};\n\nexport const createProps = (vnode, { renderer: h, Shadow }) => {\n  const attrs = vnode.attrs;\n  const state = vnode.state;\n  const children = attrs.children || vnode.children || [];\n  return Object.assign(\n    {},\n    {\n      parentClassName: [\n        attrs.parentClassName || classes.component\n      ].join(\" \"),\n      animateOnTap: false,\n      shadowComponent: h(Shadow, {\n        z: attrs.disabled ? 0 : state.z,\n        animated: true\n      }),\n      wash: attrs.wash !== undefined\n        ? attrs.wash\n        : false,\n      children\n    },\n    attrs\n  );\n};\n\nexport const createContent = vnode =>\n  vnode.children;\n"],"names":["component","MAX_Z","tapStart","tapEndAll","downButtons","animateZ","which","vnode","zBase","state","increase","attrs","z","newZ","Math","min","max","tapHandler","push","animateOnTap","initTapEvents","isServer","map","buttonVnode","pointerStartMoveEvent","forEach","dom","addEventListener","evt","pointerEndMoveEvent","document","clearTapEvents","removeEventListener","getInitialState","createStream","undefined","tapEventsInited","redrawOnUpdate","merge","onMount","onUnMount","createProps","h","renderer","Shadow","children","parentClassName","classes","join","shadowComponent","disabled","animated","wash","createContent"],"mappings":"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"}