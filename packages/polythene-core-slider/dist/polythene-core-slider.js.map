{"version":3,"file":"polythene-core-slider.js","sources":["../src/vars.js","../../polythene-css-classes/slider.js","../src/slider.js"],"sourcesContent":["import { vars } from \"polythene-theme\";\n\nconst rgba = (colorStr, opacity = 1) =>\n  `rgba(${colorStr}, ${opacity})`;\n\nconst lightForeground =                vars.color_light_foreground;\nconst darkForeground =                 vars.color_dark_foreground;\nconst activeColor =                    vars.color_primary; // or override in CSS by setting 'color' property on '.pe-slider'\nconst thumb_size =                     12;\nconst thumb_touch_size =               Math.max(40, thumb_size);\nconst thumb_border_width =             2;\nconst active_thumb_scale =             3/2;\nconst disabled_thumb_scale =           1/2;\nconst active_pin_thumb_scale =         2/6;\nconst largestThumbSize =               active_thumb_scale * thumb_size;\nconst largestElement =                 Math.max(thumb_touch_size, largestThumbSize);\nconst height =                         Math.max(52, largestThumbSize);\nconst side_spacing =                   Math.max(10, largestElement / 2 - thumb_size / 2);\nconst horizontal_layout_side_spacing = side_spacing + 4; // optimization for horizontal layout\n\nexport default {\n  general_styles:                      true,\n\n  active_pin_thumb_scale,\n  active_thumb_scale,\n  animation_duration:                  vars.animation_duration,\n  bar_height:                          2,\n  disabled_thumb_scale,\n  height,\n  horizontal_layout_side_spacing,\n  pin_font_size:                       10,\n  pin_height:                          32,\n  pin_width:                           26,\n  side_spacing,\n  step_width: 2,\n  thumb_border_width,\n  thumb_size,\n  thumb_touch_size,\n  track_height: height,\n\n  color_light_track_active:            rgba(lightForeground, .38),\n  color_light_track_inactive:          rgba(lightForeground, .26),\n  color_light_track_value:             \"currentColor\",\n  // background color may be set in theme; disabled by default\n  // color_light_thumb_background:        undefined,\n  color_light_thumb_off:               rgba(lightForeground, .26),\n  color_light_thumb_off_focus:         rgba(lightForeground),\n  color_light_thumb_off_focus_opacity: .08,\n  color_light_thumb_on:                rgba(activeColor),\n  color_light_thumb_on_focus_opacity:  .11,\n  color_light_thumb_inactive:          rgba(lightForeground, .26),\n  color_light_tick:                    rgba(lightForeground, 1),\n  color_light_tick_value:              rgba(lightForeground, 1),\n  color_light_icon:                    rgba(vars.color_light_foreground, vars.blend_light_text_secondary),\n  color_light_disabled_icon:           rgba(vars.color_light_foreground, vars.blend_light_text_disabled),\n  color_light_label:                   rgba(vars.color_light_foreground, vars.blend_light_text_secondary),\n  color_light_disabled_label:          rgba(vars.color_light_foreground, vars.blend_light_text_disabled),\n  color_light_pin_label:               \"#fff\",\n  color_light_pin_background:          \"currentColor\",\n\n  color_dark_track_active:             rgba(darkForeground, .3),\n  color_dark_track_inactive:           rgba(darkForeground, .2),\n  color_dark_track_value:              \"currentColor\",\n  // background color may be set in theme; disabled by default\n  // color_dark_thumb_background:         undefined,\n  color_dark_thumb_off:                rgba(darkForeground, .2),\n  color_dark_thumb_off_focus:          rgba(darkForeground),\n  color_dark_thumb_off_focus_opacity:  .08,\n  color_dark_thumb_on:                 rgba(activeColor),\n  color_dark_thumb_on_focus_opacity:   .11,\n  color_dark_thumb_inactive:           rgba(darkForeground, .2),\n  color_dark_tick:                     rgba(darkForeground, 1),\n  color_dark_tick_value:               rgba(darkForeground, 1),\n  color_dark_icon:                     rgba(vars.color_dark_foreground, vars.blend_dark_text_secondary),\n  color_dark_disabled_icon:            rgba(vars.color_dark_foreground, vars.blend_dark_text_disabled),\n  color_dark_label:                    rgba(vars.color_dark_foreground, vars.blend_dark_text_secondary),\n  color_dark_disabled_label:           rgba(vars.color_dark_foreground, vars.blend_dark_text_disabled),\n  color_dark_pin_label:                \"#fff\",\n  color_dark_pin_background:           \"currentColor\",\n};\n","\nexport default {\n  component:      \"pe-slider\",\n\n  // elements\n  control:        \"pe-slider__control\",\n  label:          \"pe-slider__label\",\n  pin:            \"pe-slider__pin\",\n  thumb:          \"pe-slider__thumb\",\n  tick:           \"pe-slider__tick\",\n  ticks:          \"pe-slider__ticks\",\n  track:          \"pe-slider__track\",\n  trackBar:       \"pe-slider__track-bar\",\n  trackBarValue:  \"pe-slider__track-bar-value\",\n  trackPart:      \"pe-slider__track-part\",\n  trackPartRest:  \"pe-slider__track-rest\",\n  trackPartValue: \"pe-slider__track-value\",\n\n  // states\n  hasFocus:       \"pe-slider--focus\",\n  hasPin:         \"pe-slider--pin\",\n  hasTicks:       \"pe-slider--ticks\",\n  hasTrack:       \"pe-slider--track\",\n  isActive:       \"pe-slider--active\",\n  isAtMin:        \"pe-slider--min\",\n  isDisabled:     \"pe-slider--disabled\",\n  tickValue:      \"pe-slider__tick--value\",\n};\n","import { isTouch, pointerStartMoveEvent, pointerMoveEvent, pointerEndMoveEvent, isClient, filterSupportedAttributes } from \"polythene-core\";\nimport themeVars from \"./vars\";\nimport classes from \"polythene-css-classes/slider\";\n\nconst MAX_TICKS = 100;\nlet focusElement;\n\nconst deFocus = state => {\n  if (focusElement) {\n    focusElement.blur();\n  }\n  focusElement = undefined;\n  state.hasFocus(false);\n};\n\nconst focus = (state, el) => {\n  deFocus(state);\n  focusElement = el;\n  state.hasFocus(true);\n};\n\nconst positionFromEvent = (e, isVertical) => (\n  // isVertical not yet implemented\n  isTouch && e.touches\n    ? isVertical ? e.touches[0].pageY : e.touches[0].pageX\n    : isVertical ? e.pageY : e.pageX);\n\nconst updatePinPosition = state => {\n  if (state.controlEl && state.pinEl) {\n    const left = state.fraction() * state.rangeWidth;\n    state.pinEl.style.left = left + \"px\";\n  }\n};\n\nconst updateValue = (state, value) => {\n  state.setValue(value, true);\n  updatePinPosition(state);\n};\n\nconst generateTickMarks = (h, stepCount, stepSize, value) => {\n  const items = [];\n  const stepWithValue = value / stepSize;\n  console.log(\"stepSize\", stepSize, \"value\", value, \"stepWithValue\", stepWithValue);\n  let s = 0;\n  while (s < stepCount + 1) {\n    items.push(h(\"div\", {\n      className: s <= stepWithValue\n        ? [classes.tick, classes.tickValue].join(\" \")\n        : classes.tick,\n      key: `tick-${s}`\n    }));\n    s++;\n  }\n  return items;\n};\n\nconst readRangeData = state => {\n  if (state.controlEl && isClient) {\n    // range is from the far left to the far right minus the thumb width (max x is at the left side of the thumb)\n    state.controlWidth = themeVars.thumb_size;\n    state.rangeWidth = state.trackEl.getBoundingClientRect().width - state.controlWidth;\n    const styles = window.getComputedStyle(state.trackEl);\n    state.rangeOffset = parseFloat(styles.marginLeft);\n  }\n};\n\nconst calculateClickOffset = (state, controlOffset = 0) => {\n  state.clickOffset = state.trackEl.getBoundingClientRect().left - (state.rangeOffset - state.controlWidth / 2) + controlOffset;\n};\n\nconst initControlEvent = (state, e) => {\n  const controlPos = state.controlEl.getBoundingClientRect().left;\n  const eventPos = positionFromEvent(e);\n  const controlOffset = eventPos - controlPos - state.controlWidth / 2;\n  calculateClickOffset(state, controlOffset);\n};\n\nconst initTrackEvent = (state) =>\n  calculateClickOffset(state, 0);\n\nconst handlePosEvent = (state, e) => {\n  const pos = positionFromEvent(e) - state.clickOffset;\n  const value = state.min + ((pos - state.rangeOffset) / state.rangeWidth) * (state.max - state.min);\n  updateValue(state, value);\n};\n\nconst startDrag = (state, attrs, e) => {\n  if (state.isDragging()) return;\n  e.preventDefault();\n  state.isDragging(true);\n  state.isActive(true);\n  deFocus(state);\n\n  const drag = e => {\n    if (!state.isDragging()) return;\n    handlePosEvent(state, e);\n  };\n\n  const endDrag = () => {\n    if (!state.isDragging()) return;\n    deFocus(state);\n    if (isClient) {\n      pointerMoveEvent.forEach(evt =>\n        window.removeEventListener(evt, drag));\n      pointerEndMoveEvent.forEach(evt =>\n        window.removeEventListener(evt, endDrag));\n    }\n    state.isDragging(false);\n    state.isActive(false);\n  };\n\n  if (isClient) {\n    pointerMoveEvent.forEach(evt =>\n      window.addEventListener(evt, drag));\n    pointerEndMoveEvent.forEach(evt =>\n      window.addEventListener(evt, endDrag));\n  }\n  readRangeData(state);\n\n  if (attrs.pin) {\n    updatePinPosition(state);\n  }\n};\n\nconst startTrack = (state, attrs, e) => {\n  e.preventDefault();\n  if (state.isDragging()) {\n    return;\n  }\n  readRangeData(state);\n  initTrackEvent(state);\n  handlePosEvent(state, e);\n  startDrag(state, attrs, e);\n};\n\nconst createSlider = (vnode, { h, k, hasTicks, interactiveTrack }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const fraction = state.fraction();\n  const range = state.max - state.min;\n  const stepCount = Math.min(MAX_TICKS, parseInt(range / state.stepSize, 10));\n\n  console.log(\"value\", state.value(), \"state.stepSize\", state.stepSize);\n  const onStartTrack = e => (\n    startTrack(state, attrs, e)\n  );\n\n  const onInitDrag = e => {\n    readRangeData(state);\n    initControlEvent(state, e);\n    startDrag(state, attrs, e);\n  };\n\n  const flexValueCss =  fraction + \" 1 0%\";\n  const flexRestValue = 1 - fraction;\n  const flexRestCss =   flexRestValue + \" 1 0%\";\n\n  return h(\"div\",\n    Object.assign(\n      {},\n      { className: classes.track },\n      interactiveTrack && !attrs.disabled && pointerStartMoveEvent.reduce((acc, evt) => (\n        acc[k[`on${evt}`]] = onStartTrack,\n        acc\n      ), {})\n    ),\n    [\n      h(\"div\",\n        {\n          className: classes.trackPart + \" \" + classes.trackPartValue,\n          key: \"trackPartValue\",\n          style: {\n            flex: flexValueCss,\n            msFlex: flexValueCss,\n            WebkitFlex: flexValueCss\n          }\n        },\n        h(\"div\", { className: classes.trackBar },\n          h(\"div\", { className: classes.trackBarValue })\n        )\n      ),\n      h(\"div\", Object.assign(\n        {},\n        {\n          className: classes.control,\n          key: \"control\"\n        },\n        attrs.disabled\n          ? { disabled: true }\n          : {\n            [k.tabindex]: attrs[k.tabindex] || 0,\n            [k.onfocus]: () => focus(state, state.controlEl),\n            [k.onblur]: () => deFocus(state),\n            [k.onkeydown]: e => {\n              if (e.key !== \"Tab\") {\n                e.preventDefault();\n              }\n              if (e.key === \"Escape\" || e.key === \"Esc\") {\n                state.controlEl.blur(e);\n              } else if (e.key === \"ArrowLeft\" || e.key === \"ArrowDown\" || e.key === \"Left\" || e.key === \"Down\") {\n                state.decrement(state, e.shiftKey);\n              } else if (e.key === \"ArrowRight\" || e.key === \"ArrowUp\" || e.key === \"Right\" || e.key === \"Up\") {\n                state.increment(state, e.shiftKey);\n              } else if (e.key === \"Home\") {\n                updateValue(state, state.min);\n              } else if (e.key === \"End\") {\n                updateValue(state, state.max);\n              } else if (e.key === \"PageDown\") {\n                state.decrement(state, true);\n              } else if (e.key === \"PageUp\") {\n                state.increment(state, true);\n              }\n              readRangeData(state);\n              updatePinPosition(state);\n            }\n          },\n        !attrs.disabled &&\n          pointerStartMoveEvent.reduce((acc, evt) => (\n            acc[k[`on${evt}`]] = onInitDrag,\n            acc\n          ), {}),\n        attrs.events\n          ? attrs.events\n          : null,\n        hasTicks\n          ? { step: stepCount }\n          : null\n      ),\n      attrs.icon\n        ? h(\"div\",\n          {\n            className: classes.thumb,\n            key: \"icon\"\n          },\n          attrs.icon\n        )\n        : null\n      ),\n      h(\"div\",\n        {\n          className: classes.trackPart + \" \" + classes.trackPartRest,\n          key: \"trackPartRest\",\n          style: {\n            flex: flexRestCss,\n            msFlex: flexRestCss,\n            WebkitFlex: flexRestCss,\n            maxWidth: (flexRestValue * 100) + \"%\" // for IE Edge\n          }\n        },\n        h(\"div\", { className: classes.trackBar },\n          h(\"div\", { className: classes.trackBarValue })\n        )\n      ),\n      hasTicks && !attrs.disabled\n        ? h(\"div\",\n          {\n            className: classes.ticks,\n            key: \"ticks\"\n          },\n          generateTickMarks(h, stepCount, state.stepSize, state.value())\n        )\n        : null,\n      hasTicks && attrs.pin && !attrs.disabled\n        ? h(\"div\",\n          {\n            className: classes.pin,\n            key: \"pin\",\n            value: state.value()\n          }\n        )\n        : null\n    ]\n  );\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n\n  const min = attrs.min !== undefined ? attrs.min : 0;\n  const max = attrs.max !== undefined ? attrs.max : 100;\n  const range = max - min;\n  const stepSize = attrs.stepSize !== undefined\n    ? attrs.stepSize\n    : 1;\n  const defaultValue = attrs.defaultValue !== undefined\n    ? attrs.defaultValue\n    : attrs.value !== undefined\n      ? attrs.value\n      : 0;\n  const previousValue = createStream(undefined);\n  const isActive = createStream(false);\n  const hasFocus = createStream(false);\n  const isDragging = createStream(false);\n  const fraction = createStream(min);\n  const value = createStream(0);\n  const normalizeFactor = 1 / stepSize;\n\n  const setValue = (v, shouldNotify = false) => {\n    if (v < min) v = min;\n    if (v > max) v = max;\n    value(stepSize\n      ? Math.round(v * normalizeFactor) / normalizeFactor\n      : v\n    );\n    fraction((value() - min) / range);\n    if (shouldNotify && attrs.onChange) {\n      attrs.onChange({\n        value: value()\n      });\n    }\n    previousValue(v);\n  };\n\n  const increment = (state, useLargeStep) =>\n    updateValue(state, value() + (useLargeStep ? 10 : 1) * (stepSize || 1));\n\n  const decrement = (state, useLargeStep) =>\n    updateValue(state, value() - (useLargeStep ? 10 : 1) * (stepSize || 1));\n  \n  setValue(defaultValue);\n  \n  return {\n    min,\n    max,\n    stepSize,\n    fraction,\n    // DOM elements\n    trackEl: null,\n    controlEl: null,\n    pinEl: null,\n    // functions\n    setValue,\n    increment,\n    decrement, \n    // streams\n    isDragging,\n    isActive,\n    value,\n    previousValue,\n    hasFocus,\n    // coordinates\n    controlWidth: 0,\n    rangeWidth: 0,\n    rangeOffset: 0,\n    clickOffset: 0,\n    redrawOnUpdate: createStream.merge([isActive, value])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const dom = vnode.dom;\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n\n  state.trackEl = dom.querySelector(`.${classes.track}`);\n  state.controlEl = dom.querySelector(`.${classes.control}`);\n  state.pinEl = dom.querySelector(`.${classes.pin}`);\n\n  readRangeData(state);\n\n  if (attrs.pin) {\n    setTimeout(() => {\n      updateValue(state, state.value());\n    }, 0);\n  }\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (attrs.value !== undefined) {\n    if (state.previousValue() !== attrs.value) {\n      state.previousValue(attrs.value);\n      setTimeout(() => state.setValue(state.previousValue()), 0); // perform in next tick to play nice with React\n    }\n  }\n  const hasTicks = attrs.ticks !== undefined && attrs.ticks !== false;\n  const interactiveTrack = (attrs.interactiveTrack !== undefined) ? attrs.interactiveTrack : true;\n  return Object.assign(\n    {}, \n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.disabled ? classes.isDisabled : null,\n        attrs.pin ? classes.hasPin : null,\n        interactiveTrack ? classes.hasTrack : null,\n        state.isActive() ? classes.isActive : null,\n        state.hasFocus() ? classes.hasFocus : null,\n        state.fraction() === 0 ? classes.isAtMin : null,\n        hasTicks ? classes.hasTicks : null,\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \")\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k }) => {\n  const attrs = vnode.attrs;\n  const hasTicks = attrs.ticks !== undefined && attrs.ticks !== false;\n  const interactiveTrack = (attrs.interactiveTrack !== undefined) ? attrs.interactiveTrack : true;\n  return createSlider(vnode, { h, k, hasTicks, interactiveTrack });\n};\n\n\n"],"names":["rgba","colorStr","opacity","lightForeground","vars","color_light_foreground","darkForeground","color_dark_foreground","activeColor","color_primary","thumb_size","thumb_touch_size","Math","max","thumb_border_width","active_thumb_scale","disabled_thumb_scale","active_pin_thumb_scale","largestThumbSize","largestElement","height","side_spacing","horizontal_layout_side_spacing","general_styles","animation_duration","bar_height","pin_font_size","pin_height","pin_width","step_width","track_height","color_light_track_active","color_light_track_inactive","color_light_track_value","color_light_thumb_off","color_light_thumb_off_focus","color_light_thumb_off_focus_opacity","color_light_thumb_on","color_light_thumb_on_focus_opacity","color_light_thumb_inactive","color_light_tick","color_light_tick_value","color_light_icon","blend_light_text_secondary","color_light_disabled_icon","blend_light_text_disabled","color_light_label","color_light_disabled_label","color_light_pin_label","color_light_pin_background","color_dark_track_active","color_dark_track_inactive","color_dark_track_value","color_dark_thumb_off","color_dark_thumb_off_focus","color_dark_thumb_off_focus_opacity","color_dark_thumb_on","color_dark_thumb_on_focus_opacity","color_dark_thumb_inactive","color_dark_tick","color_dark_tick_value","color_dark_icon","blend_dark_text_secondary","color_dark_disabled_icon","blend_dark_text_disabled","color_dark_label","color_dark_disabled_label","color_dark_pin_label","color_dark_pin_background","component","control","label","pin","thumb","tick","ticks","track","trackBar","trackBarValue","trackPart","trackPartRest","trackPartValue","hasFocus","hasPin","hasTicks","hasTrack","isActive","isAtMin","isDisabled","tickValue","MAX_TICKS","focusElement","deFocus","blur","undefined","state","focus","el","positionFromEvent","e","isVertical","isTouch","touches","pageY","pageX","updatePinPosition","controlEl","pinEl","left","fraction","rangeWidth","style","updateValue","value","setValue","generateTickMarks","h","stepCount","stepSize","items","stepWithValue","console","log","s","push","className","classes","join","key","readRangeData","isClient","controlWidth","themeVars","trackEl","getBoundingClientRect","width","styles","window","getComputedStyle","rangeOffset","parseFloat","marginLeft","calculateClickOffset","controlOffset","clickOffset","initControlEvent","controlPos","eventPos","initTrackEvent","handlePosEvent","pos","min","startDrag","attrs","isDragging","preventDefault","drag","endDrag","pointerMoveEvent","forEach","removeEventListener","evt","pointerEndMoveEvent","addEventListener","startTrack","createSlider","vnode","k","interactiveTrack","range","parseInt","onStartTrack","onInitDrag","flexValueCss","flexRestValue","flexRestCss","disabled","pointerStartMoveEvent","reduce","acc","flex","msFlex","WebkitFlex","tabindex","onfocus","onblur","onkeydown","decrement","shiftKey","increment","events","step","icon","maxWidth","getInitialState","createStream","defaultValue","previousValue","normalizeFactor","v","shouldNotify","round","onChange","useLargeStep","redrawOnUpdate","merge","onMount","dom","querySelector","setTimeout","createProps","keys","filterSupportedAttributes","tone","class","createContent","renderer"],"mappings":"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"}