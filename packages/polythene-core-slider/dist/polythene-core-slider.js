!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("polythene-core")):"function"==typeof define&&define.amd?define(["exports","polythene-core"],t):t((e=e||self).polythene={},e["polythene-core"])}(this,function(e,t){"use strict";var i={component:"pe-slider",control:"pe-slider__control",label:"pe-slider__label",pin:"pe-slider__pin",thumb:"pe-slider__thumb",tick:"pe-slider__tick",ticks:"pe-slider__ticks",track:"pe-slider__track",trackBar:"pe-slider__track-bar",trackBarValue:"pe-slider__track-bar-value",trackPart:"pe-slider__track-part",trackPartRest:"pe-slider__track-rest",trackPartValue:"pe-slider__track-value",hasFocus:"pe-slider--focus",hasPin:"pe-slider--pin",hasTicks:"pe-slider--ticks",hasTrack:"pe-slider--track",isActive:"pe-slider--active",isAtMin:"pe-slider--min",isDisabled:"pe-slider--disabled",tickValue:"pe-slider__tick--value"};let a;const r=e=>{a&&a.blur(),a=void 0,e.hasFocus(!1)},n=(e,i)=>t.isTouch&&e.touches?i?e.touches[0].pageY:e.touches[0].pageX:i?e.pageY:e.pageX,s=e=>{if(e.controlEl&&e.pinEl){const t=e.fraction()*e.rangeWidth;e.pinEl.style.left=t+"px"}},l=(e,t)=>{e.setValue(t,!0),s(e)},c=(e,t,a,r)=>{const n=[],s=r/a;let l=0;for(;l<t+1;)n.push(e("div",{className:l<=s?[i.tick,i.tickValue].join(" "):i.tick,key:`tick-${l}`})),l++;return n},o=e=>{if(e.controlEl&&t.isClient){e.controlWidth=parseFloat(t.getStyle({element:e.controlEl,prop:"width"})),e.rangeWidth=e.trackEl.getBoundingClientRect().width-e.controlWidth;const i=window.getComputedStyle(e.trackEl);e.rangeOffset=parseFloat(i.marginLeft)}},d=(e,t=0)=>{e.clickOffset=e.trackEl.getBoundingClientRect().left-(e.rangeOffset-e.controlWidth/2)+t},u=(e,t)=>{const i=n(t)-e.clickOffset,a=e.min+(i-e.rangeOffset)/e.rangeWidth*(e.max-e.min);l(e,a)},k=(e,i,a)=>{if(e.isDragging())return;a.preventDefault(),e.isDragging(!0),e.isActive(!0),r(e);const n=t=>{e.isDragging()&&u(e,t)},l=()=>{e.isDragging()&&(r(e),t.isClient&&(t.pointerMoveEvent.forEach(e=>window.removeEventListener(e,n)),t.pointerEndMoveEvent.forEach(e=>window.removeEventListener(e,l))),e.isDragging(!1),e.isActive(!1))};t.isClient&&(t.pointerMoveEvent.forEach(e=>window.addEventListener(e,n)),t.pointerEndMoveEvent.forEach(e=>window.addEventListener(e,l))),o(e),i.pin&&s(e)},p=(e,t,i)=>{i.preventDefault(),e.isDragging()||(o(e),(e=>d(e,0))(e),u(e,i),k(e,t,i))},v=(e,{h:u,k:v,hasTicks:f,interactiveTrack:m})=>{const g=e.state,h=e.attrs,y=g.fraction(),E=g.max-g.min,b=Math.min(100,parseInt(E/g.stepSize,10)),_=e=>p(g,h,e),w=e=>{o(g),((e,t)=>{const i=e.controlEl.getBoundingClientRect().left,a=n(t)-i-e.controlWidth/2;d(e,a)})(g,e),k(g,h,e)},x=y+" 1 0%",V=1-y,T=V+" 1 0%";return u("div",Object.assign({},{className:i.track},m&&!h.disabled&&t.pointerStartMoveEvent.reduce((e,t)=>(e[v[`on${t}`]]=_,e),{})),[u("div",{className:i.trackPart+" "+i.trackPartValue,key:"trackPartValue",style:{flex:x,msFlex:x,WebkitFlex:x}},u("div",{className:i.trackBar},u("div",{className:i.trackBarValue}))),u("div",Object.assign({},{className:i.control,key:"control"},h.disabled?{disabled:!0}:{[v.tabindex]:h[v.tabindex]||0,[v.onfocus]:()=>((e,t)=>{r(e),a=t,e.hasFocus(!0)})(g,g.controlEl),[v.onblur]:()=>r(g),[v.onkeydown]:e=>{"Tab"!==e.key&&e.preventDefault(),"Escape"===e.key||"Esc"===e.key?g.controlEl.blur(e):"ArrowLeft"===e.key||"ArrowDown"===e.key||"Left"===e.key||"Down"===e.key?g.decrement(g,e.shiftKey):"ArrowRight"===e.key||"ArrowUp"===e.key||"Right"===e.key||"Up"===e.key?g.increment(g,e.shiftKey):"Home"===e.key?l(g,g.min):"End"===e.key?l(g,g.max):"PageDown"===e.key?g.decrement(g,!0):"PageUp"===e.key&&g.increment(g,!0),o(g),s(g)}},!h.disabled&&t.pointerStartMoveEvent.reduce((e,t)=>(e[v[`on${t}`]]=w,e),{}),h.events?h.events:null,f?{step:b}:null),h.icon?u("div",{className:i.thumb,key:"icon"},h.icon):null),u("div",{className:i.trackPart+" "+i.trackPartRest,key:"trackPartRest",style:{flex:T,msFlex:T,WebkitFlex:T,maxWidth:100*V+"%"}},u("div",{className:i.trackBar},u("div",{className:i.trackBarValue}))),f&&!h.disabled?u("div",{className:i.ticks,key:"ticks"},c(u,b,g.stepSize,g.value())):null,f&&h.pin&&!h.disabled?u("div",{className:i.pin,key:"pin",value:g.value()}):null])};var f=Object.freeze({getInitialState:(e,t)=>{const i=e.attrs,a=void 0!==i.min?i.min:0,r=void 0!==i.max?i.max:100,n=r-a,s=void 0!==i.stepSize?i.stepSize:1,c=void 0!==i.defaultValue?i.defaultValue:void 0!==i.value?i.value:0,o=t(void 0),d=t(!1),u=t(!1),k=t(!1),p=t(a),v=t(0),f=1/s,m=(e,t=!1)=>{e<a&&(e=a),e>r&&(e=r),v(s?Math.round(e*f)/f:e),p((v()-a)/n),t&&i.onChange&&i.onChange({value:v()}),o(e)};return m(c),{min:a,max:r,stepSize:s,fraction:p,trackEl:null,controlEl:null,pinEl:null,setValue:m,increment:(e,t)=>l(e,v()+(t?10:1)*(s||1)),decrement:(e,t)=>l(e,v()-(t?10:1)*(s||1)),isDragging:k,isActive:d,value:v,previousValue:o,hasFocus:u,controlWidth:0,rangeWidth:0,rangeOffset:0,clickOffset:0,redrawOnUpdate:t.merge([d,v])}},onMount:e=>{if(!e.dom)return;const t=e.dom,a=e.state,r=e.attrs;a.trackEl=t.querySelector(`.${i.track}`),a.controlEl=t.querySelector(`.${i.control}`),a.pinEl=t.querySelector(`.${i.pin}`),o(a),r.pin&&setTimeout(()=>{l(a,a.value())},0)},createProps:(e,{keys:a})=>{const r=e.state,n=e.attrs;void 0!==n.value&&r.previousValue()!==n.value&&(r.previousValue(n.value),setTimeout(()=>r.setValue(r.previousValue()),0));const s=void 0!==n.ticks&&!1!==n.ticks,l=void 0===n.interactiveTrack||n.interactiveTrack;return Object.assign({},t.filterSupportedAttributes(n),{className:[i.component,n.disabled?i.isDisabled:null,n.pin?i.hasPin:null,l?i.hasTrack:null,r.isActive()?i.isActive:null,r.hasFocus()?i.hasFocus:null,0===r.fraction()?i.isAtMin:null,s?i.hasTicks:null,"dark"===n.tone?"pe-dark-tone":null,"light"===n.tone?"pe-light-tone":null,n.className||n[a.class]].join(" ")})},createContent:(e,{renderer:t,keys:i})=>{const a=e.attrs,r=void 0!==a.ticks&&!1!==a.ticks,n=void 0===a.interactiveTrack||a.interactiveTrack;return v(e,{h:t,k:i,hasTicks:r,interactiveTrack:n})}});e.coreSlider=f,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-core-slider.js.map
