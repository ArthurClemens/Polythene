!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("polythene-core")):"function"==typeof define&&define.amd?define(["exports","polythene-core"],t):t((e=e||self).polythene={},e["polythene-core"])}(this,function(e,t){"use strict";function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}var r,a={component:"pe-slider",control:"pe-slider__control",label:"pe-slider__label",pin:"pe-slider__pin",thumb:"pe-slider__thumb",tick:"pe-slider__tick",ticks:"pe-slider__ticks",track:"pe-slider__track",trackBar:"pe-slider__track-bar",trackBarValue:"pe-slider__track-bar-value",trackPart:"pe-slider__track-part",trackPartRest:"pe-slider__track-rest",trackPartValue:"pe-slider__track-value",hasFocus:"pe-slider--focus",hasPin:"pe-slider--pin",hasTicks:"pe-slider--ticks",hasTrack:"pe-slider--track",isActive:"pe-slider--active",isAtMin:"pe-slider--min",isDisabled:"pe-slider--disabled",tickValue:"pe-slider__tick--value"},c=function(e){r&&r.blur(),r=void 0,e.hasFocus(!1)},o=function(e,n){return t.isTouch&&e.touches?n?e.touches[0].pageY:e.touches[0].pageX:n?e.pageY:e.pageX},l=function(e){if(e.controlEl&&e.pinEl){var t=e.fraction()*e.rangeWidth;e.pinEl.style.left=t+"px"}},s=function(e,t){e.setValue(t,!0),l(e)},u=function(e,t,n,i){for(var r=[],c=i/n,o=0;o<t+1;)r.push(e("div",{className:o<=c?[a.tick,a.tickValue].join(" "):a.tick,key:"tick-".concat(o)})),o++;return r},d=function(e){if(e.controlEl&&t.isClient){e.controlWidth=parseFloat(t.getStyle({element:e.controlEl,prop:"width"})),e.rangeWidth=e.trackEl.getBoundingClientRect().width-e.controlWidth;var n=window.getComputedStyle(e.trackEl);e.rangeOffset=parseFloat(n.marginLeft)}},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.clickOffset=e.trackEl.getBoundingClientRect().left-(e.rangeOffset-e.controlWidth/2)+t},v=function(e,t){var n=o(t)-e.clickOffset,i=e.min+(n-e.rangeOffset)/e.rangeWidth*(e.max-e.min);s(e,i)},p=function(e,n,i){if(!e.isDragging()){i.preventDefault(),e.isDragging(!0),e.isActive(!0),c(e);var r=function(t){e.isDragging()&&v(e,t)},a=function n(){e.isDragging()&&(c(e),t.isClient&&(t.pointerMoveEvent.forEach(function(e){return window.removeEventListener(e,r)}),t.pointerEndMoveEvent.forEach(function(e){return window.removeEventListener(e,n)})),e.isDragging(!1),e.isActive(!1))};t.isClient&&(t.pointerMoveEvent.forEach(function(e){return window.addEventListener(e,r)}),t.pointerEndMoveEvent.forEach(function(e){return window.addEventListener(e,a)})),d(e),n.pin&&l(e)}},k=function(e,t,n){n.preventDefault(),e.isDragging()||(d(e),function(e){f(e,0)}(e),v(e,n),p(e,t,n))},h=function(e,v){var h,g=v.h,m=v.k,y=v.hasTicks,E=v.interactiveTrack,b=e.state,_=e.attrs,w=b.fraction(),x=b.max-b.min,P=Math.min(100,parseInt(x/b.stepSize,10)),V=function(e){return k(b,_,e)},T=function(e){d(b),function(e,t){var n=e.controlEl.getBoundingClientRect().left,i=o(t)-n-e.controlWidth/2;f(e,i)}(b,e),p(b,_,e)},D=w+" 1 0%",S=1-w,N=S+" 1 0%";return g("div",i({},{className:a.track},E&&!_.disabled&&t.pointerStartMoveEvent.reduce(function(e,t){return e[m["on".concat(t)]]=V,e},{})),[g("div",{className:a.trackPart+" "+a.trackPartValue,key:"trackPartValue",style:{flex:D,msFlex:D,WebkitFlex:D}},g("div",{className:a.trackBar},g("div",{className:a.trackBarValue}))),g("div",i({},{className:a.control,key:"control"},_.disabled?{disabled:!0}:(h={},n(h,m.tabindex,_[m.tabindex]||0),n(h,m.onfocus,function(){return function(e,t){c(e),r=t,e.hasFocus(!0)}(b,b.controlEl)}),n(h,m.onblur,function(){return c(b)}),n(h,m.onkeydown,function(e){"Tab"!==e.key&&e.preventDefault(),"Escape"===e.key||"Esc"===e.key?b.controlEl.blur(e):"ArrowLeft"===e.key||"ArrowDown"===e.key||"Left"===e.key||"Down"===e.key?b.decrement(b,e.shiftKey):"ArrowRight"===e.key||"ArrowUp"===e.key||"Right"===e.key||"Up"===e.key?b.increment(b,e.shiftKey):"Home"===e.key?s(b,b.min):"End"===e.key?s(b,b.max):"PageDown"===e.key?b.decrement(b,!0):"PageUp"===e.key&&b.increment(b,!0),d(b),l(b)}),h),!_.disabled&&t.pointerStartMoveEvent.reduce(function(e,t){return e[m["on".concat(t)]]=T,e},{}),_.events?_.events:null,y?{step:P}:null),_.icon?g("div",{className:a.thumb,key:"icon"},_.icon):null),g("div",{className:a.trackPart+" "+a.trackPartRest,key:"trackPartRest",style:{flex:N,msFlex:N,WebkitFlex:N,maxWidth:100*S+"%"}},g("div",{className:a.trackBar},g("div",{className:a.trackBarValue}))),y&&!_.disabled?g("div",{className:a.ticks,key:"ticks"},u(g,P,b.stepSize,b.value())):null,y&&_.pin&&!_.disabled?g("div",{className:a.pin,key:"pin",value:b.value()}):null])},g=Object.freeze({getInitialState:function(e,t){var n=e.attrs,i=void 0!==n.min?n.min:0,r=void 0!==n.max?n.max:100,a=r-i,c=void 0!==n.stepSize?n.stepSize:1,o=void 0!==n.defaultValue?n.defaultValue:void 0!==n.value?n.value:0,l=t(void 0),u=t(!1),d=t(!1),f=t(!1),v=t(i),p=t(0),k=1/c,h=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e<i&&(e=i),e>r&&(e=r),p(c?Math.round(e*k)/k:e),v((p()-i)/a),t&&n.onChange&&n.onChange({value:p()}),l(e)};return h(o),{min:i,max:r,stepSize:c,fraction:v,trackEl:null,controlEl:null,pinEl:null,setValue:h,increment:function(e,t){return s(e,p()+(t?10:1)*(c||1))},decrement:function(e,t){return s(e,p()-(t?10:1)*(c||1))},isDragging:f,isActive:u,value:p,previousValue:l,hasFocus:d,controlWidth:0,rangeWidth:0,rangeOffset:0,clickOffset:0,redrawOnUpdate:t.merge([u,p])}},onMount:function(e){if(e.dom){var t=e.dom,n=e.state,i=e.attrs;n.trackEl=t.querySelector(".".concat(a.track)),n.controlEl=t.querySelector(".".concat(a.control)),n.pinEl=t.querySelector(".".concat(a.pin)),d(n),i.pin&&setTimeout(function(){s(n,n.value())},0)}},createProps:function(e,n){var r=n.keys,c=e.state,o=e.attrs;void 0!==o.value&&c.previousValue()!==o.value&&(c.previousValue(o.value),setTimeout(function(){return c.setValue(c.previousValue())},0));var l=void 0!==o.ticks&&!1!==o.ticks,s=void 0===o.interactiveTrack||o.interactiveTrack;return i({},t.filterSupportedAttributes(o),{className:[a.component,o.disabled?a.isDisabled:null,o.pin?a.hasPin:null,s?a.hasTrack:null,c.isActive()?a.isActive:null,c.hasFocus()?a.hasFocus:null,0===c.fraction()?a.isAtMin:null,l?a.hasTicks:null,"dark"===o.tone?"pe-dark-tone":null,"light"===o.tone?"pe-light-tone":null,o.className||o[r.class]].join(" ")})},createContent:function(e,t){var n=t.renderer,i=t.keys,r=e.attrs,a=void 0!==r.ticks&&!1!==r.ticks,c=void 0===r.interactiveTrack||r.interactiveTrack;return h(e,{h:n,k:i,hasTicks:a,interactiveTrack:c})}});e.coreSlider=g,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-core-slider.js.map
