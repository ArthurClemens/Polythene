!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("polythene-core"),require("polythene-utilities")):"function"==typeof define&&define.amd?define(["exports","polythene-core","polythene-utilities"],e):e(t.polythene={},t["polythene-core"],t["polythene-utilities"])}(this,function(t,e,n){"use strict";var o={component:"pe-tabs",indicator:"pe-tabs__indicator",scrollButton:"pe-tabs__scroll-button",scrollButtonAtEnd:"pe-tabs__scroll-button-end",scrollButtonAtStart:"pe-tabs__scroll-button-start",tab:"pe-tab",tabContent:"pe-tabs__tab-content",tabRow:"pe-tabs__row",activeSelectable:"pe-tabs__active--selectable",isAtEnd:"pe-tabs--end",isAtStart:"pe-tabs--start",isAutofit:"pe-tabs--autofit",isMenu:"pe-tabs--menu",scrollable:"pe-tabs--scrollable",compactTabs:"pe-tabs--compact",tabHasIcon:"pe-tabs__tab--icon",tabRowCentered:"pe-tabs__row--centered",tabRowIndent:"pe-tabs__row--indent",label:"pe-button__label"};const s=(t,e)=>{const n=void 0!==e.selectedTabIndex?e.selectedTabIndex:void 0!==e.selectedTab?e.selectedTab:void 0;return void 0!==n?n:Array.isArray(e.tabs)?e.tabs.reduce((t,e,n)=>void 0!==t||e.disabled?t:n,void 0):void 0},a=(t,e,n,o)=>{n.stopPropagation(),n.preventDefault();const s=t.selectedTabIndex(),a=((t,e)=>{const n=e.length-1;return{backward:Math.max(t-1,0),forward:Math.min(t+1,n)}})(s,t.tabs)[o];a!==s?c(t,e,a,!0):l(t,a)},l=(t,e)=>{const o=t.tabs,s=t.tabRowEl,a=o.slice(0,e).reduce((t,e)=>t+e.dom.getBoundingClientRect().width,0),l=s.getBoundingClientRect().width,c=s.scrollWidth-l,i=t.isRTL?-1*Math.min(a,c):Math.min(a,c),d=s.scrollLeft;if(d!==i){const e=Math.abs(d-i)/600;setTimeout(()=>{n.scrollTo({element:s,to:i,duration:Math.max(.5,e),direction:"horizontal"}).then(()=>r(t))},1e3*.15)}},r=t=>{const e=t.tabRowEl,n=e.scrollLeft,o=t.selectedTabIndex(),s=t.tabsEl,a=t.tabs.length-1,l=0===e.scrollLeft&&0===o,r=n>=e.scrollWidth-s.getBoundingClientRect().width-1&&o===a;t.scrollButtonAtStart(l),t.scrollButtonAtEnd(r)},c=(t,e,n,o)=>{if(t.selectedTabIndex(n),!t.tabs.length)return;const s=t.tabs[n].dom;s&&t.tabIndicatorEl&&t.tabsEl&&((t,e,n)=>{const o=n.tabsEl.getBoundingClientRect(),s=t.getBoundingClientRect(),a=n.managesScroll?s.height:0,l=`translate(${n.isRTL?s.right-o.right+n.tabRowEl.scrollLeft+a:s.left-o.left+n.tabRowEl.scrollLeft-a}px, 0) scaleX(${1/(o.width-2*a)*s.width})`,r=e?.25:0,c=n.tabIndicatorEl.style;c["transition-duration"]=r+"s",c.transform=l})(s,o,t),t.managesScroll&&r(t),l(t,n),e.onChange&&e.onChange({index:n,options:t.tabs[n].attrs,el:s})},i=(t,e)=>t<e?1:t>e?-1:0;var d=Object.freeze({getInitialState:(t,n)=>{t.state;const o=t.attrs;void 0!==o.selectedTab&&e.deprecation("Tabs",{option:"selectedTab",newOption:"selectedTabIndex"});const a=n(s(0,o)||0),l=n(!0),r=n(!0);return{tabsEl:void 0,tabRowEl:void 0,tabs:[],tabRow:void 0,tabIndicatorEl:void 0,selectedTabIndex:a,previousSelectedTabIndex:void 0,managesScroll:o.scrollable&&!e.isTouch,scrollButtonAtStart:l,scrollButtonAtEnd:r,scrollButtons:{start:void 0,end:void 0},registerTabButton:t=>(e,n)=>t.tabs[e]=n,registerScrollButton:t=>(e,n)=>t.scrollButtons[e]=n,isRTL:!1,cleanUp:void 0,redrawOnUpdate:n.merge([a,l,r])}},onMount:t=>{if(!t.dom)return;const n=t.dom,s=t.state,a=t.attrs;s.tabsEl=n,s.isRTL=e.isRTL({element:n}),a.hideIndicator||(s.tabIndicatorEl=n.querySelector(`.${o.indicator}`)),s.tabRowEl=n.querySelector(`.${o.tabRow}`);const l=()=>((()=>{if(s.tabs&&a.largestWidth){const t=s.tabs.map(t=>t.dom.getBoundingClientRect().width).sort(i)[0];s.tabs.forEach(e=>e.dom.style.width=t+"px")}})(),c(s,a,s.selectedTabIndex(),!1)),r=({name:t})=>"active"===t||"inactive"===t?l():null;e.subscribe("resize",l),e.subscribe("webfontloader",r),s.cleanUp=(()=>(e.unsubscribe("resize",l),e.unsubscribe("webfontloader",r))),(()=>Promise.resolve())().then(l)},onUnMount:({state:t})=>t.cleanUp(),createProps:(t,{keys:n})=>{const a=t.state,l=t.attrs,r=!l.scrollable&&!l.centered&&!!l.autofit,i=s(0,l);return void 0!==i&&a.previousSelectedTabIndex!==i&&c(a,l,i,!0),a.previousSelectedTabIndex=i,Object.assign({},e.filterSupportedAttributes(l),{className:[o.component,l.scrollable?o.scrollable:null,a.scrollButtonAtStart()?o.isAtStart:null,a.scrollButtonAtEnd()?o.isAtEnd:null,l.activeSelected?o.activeSelectable:null,r?o.isAutofit:null,l.compact?o.compactTabs:null,l.menu?o.isMenu:null,"dark"===l.tone?"pe-dark-tone":null,"light"===l.tone?"pe-light-tone":null,l.className||l[n.class]].join(" ")})},createContent:(t,{renderer:e,keys:n,Tab:s,ScrollButton:l})=>{const r=t.state,i=t.attrs,d=i.content?i.content:i.tabs?i.tabs:i.children||t.children||[];0===d.length&&console.error("No tabs specified");const b=d.map((t={},n)=>{const o=Object.assign({},t,{selected:n===r.selectedTabIndex(),animateOnTap:!1!==i.animateOnTap},i.all,{index:n,key:t.key||`tab-${n}`,register:r.registerTabButton(r),onSelect:()=>c(r,i,n,!i.noIndicatorSlide)});return e(s,o)});let u,p;i.scrollable&&(u=e(l,Object.assign({},{key:"backward",icon:i.scrollIconBackward,className:o.scrollButtonAtStart,position:"start",register:r.registerScrollButton(r),events:{[n.onclick]:t=>a(r,i,t,"backward")},isRTL:r.isRTL})),p=e(l,Object.assign({},{key:"forward",icon:i.scrollIconForward,className:o.scrollButtonAtEnd,position:"end",register:r.registerScrollButton(r),events:{[n.onclick]:t=>a(r,i,t,"forward")},isRTL:r.isRTL})));const v=i.hideIndicator?null:e("div",{key:"indicator",className:o.indicator});return[i.scrollable?u:null,e("div",{key:"tabrow",className:[o.tabRow,i.centered?o.tabRowCentered:null,i.scrollable?o.tabRowIndent:null].join(" ")},[b,v]),i.scrollable?p:null]}});var b=Object.freeze({onMount:t=>{if(!t.dom)return;const e=t.dom,n=t.attrs;n.register(n.index,{attrs:n,dom:e})},createProps:(t,{renderer:e,keys:n,Icon:s})=>{const a=t.attrs;return a.events=a.events||{},a.events[n.onclick]=a.events[n.onclick]||(()=>{}),Object.assign({},a,{content:e("div",{className:o.tabContent},[a.icon?e(s,a.icon):null,a.label?e("div",{className:o.label},e("span",a.label)):null]),className:[o.tab,a.icon&&a.label?o.tabHasIcon:null,a.className||a[n.class]].join(" "),selected:a.selected,wash:!1,ripple:!0,events:Object.assign({},a.events,{[n.onclick]:t=>{a.onSelect(),a.events[n.onclick](t)}})})},createContent:t=>t.children});const u='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>',p='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>';var v=Object.freeze({onMount:t=>{if(!t.dom)return;const e=t.dom,n=t.attrs;n.register(n.position,e)},createProps:(t,{renderer:e,keys:n})=>{const s=t.attrs,a="start"===s.position?s.icon||{svg:{content:e.trust(s.isRTL?p:u)}}:s.icon||{svg:{content:e.trust(s.isRTL?u:p)}};return{className:[o.scrollButton,s.className||s[n.class]].join(" "),icon:a,ripple:{center:!0},events:s.events}}});t.coreTabs=d,t.coreTab=b,t.coreScrollButton=v,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=polythene-core-tabs.js.map
