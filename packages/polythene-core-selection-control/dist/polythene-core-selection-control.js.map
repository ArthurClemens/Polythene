{"version":3,"file":"polythene-core-selection-control.js","sources":["../../polythene-css-classes/selection-control.js","../src/selection-control.js","../src/ViewControl.js","../src/SelectionControl.js"],"sourcesContent":["\nexport default {\n  component: \"pe-control\",\n\n  // elements\n  formLabel: \"pe-control__form-label\",\n  input:     \"pe-control__input\",\n  label:     \"pe-control__label\",\n\n  // states\n  disabled:  \"pe-control--disabled\",\n  inactive:  \"pe-control--inactive\",\n  large:     \"pe-control--large\",\n  medium:    \"pe-control--medium\",\n  off:       \"pe-control--off\",\n  on:        \"pe-control--on\",\n  regular:   \"pe-control--regular\",\n  small:     \"pe-control--small\",\n\n  // control view elements\n  box:       \"pe-control__box\",\n  button:    \"pe-control__button\",\n\n  // control view states\n  buttonOff: \"pe-control__button--off\",\n  buttonOn:  \"pe-control__button--on\",\n};\n","import { filterSupportedAttributes, classForSize } from \"polythene-core\";\nimport classes from \"polythene-css-classes/selection-control\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\nconst currentState = (attrs, state) => {\n  const checked = attrs.checked !== undefined\n    ? attrs.checked\n    : state.checked();\n  const selectable = attrs.selectable !== undefined\n    ? attrs.selectable(checked)\n    : false;\n  const inactive = attrs.disabled || !selectable;\n  return { checked, inactive };\n};\n\nexport const getInitialState = (vnode, createStream, { keys: k }) => {\n  const attrs = vnode.attrs;\n  const isChecked = attrs.defaultChecked !== undefined\n    ? attrs.defaultChecked\n    : attrs.checked || false;\n  const checked = createStream(isChecked);\n\n  const notifyChange = (e, isChecked) => {\n    if (attrs.onChange) {\n      attrs.onChange({\n        event: e,\n        checked: isChecked,\n        value: attrs.value\n      });\n    } \n  };\n\n  const onChange = e => {\n    let isChecked = e.currentTarget.checked;\n    if (attrs.type === \"radio\") {\n      // do not set directly\n    } else {\n      checked(isChecked);\n    }\n    notifyChange(e, isChecked);\n  };\n\n  const toggle = e => {\n    const newChecked = !checked();\n    checked(newChecked);\n    notifyChange(e, newChecked);\n  };\n\n  const viewControlClickHandler = attrs.events && attrs.events[k.onclick];\n  const viewControlKeyDownHandler = attrs.events && attrs.events[k.onkeydown]\n    ? attrs.events[k.onkeydown]\n    : e => {\n      if (e.key === \"Enter\" || e.keyCode === 32) {\n        e.preventDefault();\n        if (viewControlClickHandler) {\n          viewControlClickHandler(e);\n        } else {\n          toggle(e);\n        }\n      }\n    };\n\n  return {\n    checked,\n    toggle,\n    onChange,\n    viewControlClickHandler,\n    viewControlKeyDownHandler,\n    redrawOnUpdate: createStream.merge([checked])\n  };\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  const state = vnode.state;\n  const { checked, inactive } = currentState(attrs, state);\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    attrs.testId && { \"data-test-id\": attrs.testId },\n    {\n      className: [\n        classes.component,\n        attrs.instanceClass, // for instance pe-checkbox-control\n        checked ? classes.on : classes.off,\n        attrs.disabled ? classes.disabled : null,\n        inactive ? classes.inactive : null,\n        classForSize(classes, attrs.size),\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \")\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k, ViewControl }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const { checked, inactive } = currentState(attrs, state);\n  \n\n  return h(\"label\",\n    Object.assign(\n      {},\n      {\n        className: classes.formLabel,\n      },\n      state.viewControlClickHandler && {\n        [k.onclick]: e => (\n          e.preventDefault(),\n          state.viewControlClickHandler(e)\n        )\n      }\n    ),\n    [\n      h(ViewControl, Object.assign(\n        {},\n        attrs,\n        {\n          inactive,\n          checked,\n          key: \"control\",\n          events: {\n            // Only use key down event; click events are handled by input element\n            [k.onkeydown]: state.viewControlKeyDownHandler\n          }\n        }\n      )),\n      attrs.label\n        ? h(`.${classes.label}`,\n          { key: \"label\" },\n          attrs.label\n        )\n        : null,\n      h(\"input\", Object.assign(\n        {},\n        attrs.events,\n        {\n          name: attrs.name,\n          type: attrs.type,\n          value: attrs.value,\n          checked\n        },\n        attrs.disabled || inactive\n          ? { disabled: \"disabled\" }\n          : {\n            [k.onchange]: state.onChange\n          }\n      ))\n    ]\n  );\n};\n","import classes from \"polythene-css-classes/selection-control\";\n\nconst CONTENT = [\n  { iconType: \"iconOn\", className: classes.buttonOn},\n  { iconType: \"iconOff\", className: classes.buttonOff}\n];\n\n// export const getElement = vnode =>\n//   vnode.props.element || `.${classes.box}`;\n\nconst createIcon = (h, iconType, props, className) => (\n  // if props.iconOn/props.iconOff is passed, use that icon options object and ignore size\n  // otherwise create a new object\n  Object.assign(\n    {},\n    {\n      className,\n      key: iconType\n    },\n    props[iconType]\n      ? props[iconType]\n      : { svg: { content: h.trust(props.icons[iconType]) } },\n    props.icon,\n    props.size\n      ? { size: props.size }\n      : null\n  )\n);\n\nexport const _ViewControl = ({ h, Icon, IconButton, ...props }) => {\n  const element = props.element || `.${classes.box}`;\n  const content = h(IconButton, Object.assign({},\n    {\n      element: \"div\",\n      className: classes.button,\n      content: CONTENT.map(o =>\n        h(Icon, createIcon(h, o.iconType, props, o.className))\n      ),\n      ripple: { center: true },\n      disabled: props.disabled,\n      events: props.events,\n      inactive: props.inactive\n    },\n    props.iconButton // for example for hover behaviour\n  ));\n  return h(element, null, content);\n};\n","import { filterSupportedAttributes, classForSize } from \"polythene-core\";\nimport classes from \"polythene-css-classes/selection-control\";\n\nexport const _SelectionControl = ({ h, a, useState, ViewControl, ...props }) => {\n  const defaultChecked = props.defaultChecked !== undefined\n    ? props.defaultChecked\n    : props.checked || false;\n  const [previousIsChecked, setIsChecked] = useState(defaultChecked);\n\n  const isChecked = props.checked !== undefined\n    ? props.checked\n    : previousIsChecked;\n  const selectable = props.selectable !== undefined\n    ? props.selectable(isChecked)\n    : false;\n  const inactive = props.disabled || !selectable;\n\n  const notifyChange = (e, isChecked) => {\n    if (props.onChange) {\n      props.onChange({\n        event: e,\n        checked: isChecked,\n        value: props.value\n      });\n    } \n  };\n\n  const onChange = e => {\n    let isChecked = e.currentTarget.checked;\n    if (props.type === \"radio\") {\n      // do not set directly\n    } else {\n      setIsChecked(isChecked);\n    }\n    notifyChange(e, isChecked);\n  };\n\n  const toggle = e => {\n    const newChecked = !isChecked;\n    setIsChecked(newChecked);\n    notifyChange(e, newChecked);\n  };\n\n  const viewControlClickHandler = props.events && props.events[a.onclick];\n  const viewControlKeyDownHandler = props.events && props.events[a.onkeydown]\n    ? props.events[a.onkeydown]\n    : e => {\n      if (e.key === \"Enter\" || e.keyCode === 32) {\n        e.preventDefault();\n        if (viewControlClickHandler) {\n          viewControlClickHandler(e);\n        } else {\n          toggle(e);\n        }\n      }\n    };\n\n  const componentProps = Object.assign(\n    {},\n    filterSupportedAttributes(props),\n    props.testId && { \"data-test-id\": props.testId },\n    {\n      className: [\n        classes.component,\n        props.instanceClass, // for instance pe-checkbox-control\n        isChecked ? classes.on : classes.off,\n        props.disabled ? classes.disabled : null,\n        inactive ? classes.inactive : null,\n        classForSize(classes, props.size),\n        props.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        props.tone === \"light\" ? \"pe-light-tone\" : null,\n        props.className || props[a.class],\n      ].join(\" \")\n    }\n  );\n\n  const content = h(\"label\",\n    Object.assign(\n      {},\n      {\n        className: classes.formLabel,\n      },\n      viewControlClickHandler && {\n        [a.onclick]: e => (\n          e.preventDefault(),\n          viewControlClickHandler(e)\n        )\n      }\n    ),\n    [\n      h(ViewControl, Object.assign(\n        {},\n        props,\n        {\n          inactive,\n          checked: isChecked,\n          key: \"control\",\n          events: {\n            // Only use key down event; click events are handled by input element\n            [a.onkeydown]: viewControlKeyDownHandler\n          }\n        }\n      )),\n      props.label\n        ? h(`.${classes.label}`,\n          { key: \"label\" },\n          props.label\n        )\n        : null,\n      h(\"input\", Object.assign(\n        {},\n        props.events,\n        {\n          name: props.name,\n          type: props.type,\n          value: props.value,\n          checked: isChecked\n        },\n        props.disabled || inactive\n          ? { disabled: \"disabled\" }\n          : {\n            [a.onchange]: onChange\n          }\n      ))\n    ]\n  );\n  return h(props.element || \"div\", componentProps, content);\n};\n"],"names":["component","formLabel","input","label","disabled","inactive","large","medium","off","on","regular","small","box","button","buttonOff","buttonOn","currentState","attrs","state","checked","undefined","selectable","vnode","element","createStream","k","keys","defaultChecked","notifyChange","e","isChecked","onChange","event","value","toggle","newChecked","viewControlClickHandler","events","onclick","viewControlKeyDownHandler","onkeydown","key","keyCode","preventDefault","currentTarget","type","redrawOnUpdate","merge","_extends","filterSupportedAttributes","testId","className","classes","instanceClass","classForSize","size","tone","class","join","h","renderer","ViewControl","name","onchange","CONTENT","iconType","a","useState","props","previousIsChecked","setIsChecked","componentProps","content","Icon","IconButton","map","o","svg","trust","icons","icon","createIcon","ripple","center","iconButton"],"mappings":"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"}