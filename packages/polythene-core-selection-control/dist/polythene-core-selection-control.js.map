{"version":3,"file":"polythene-core-selection-control.js","sources":["../../polythene-css-classes/selection-control.js","../src/ViewControl.js","../src/SelectionControl.js"],"sourcesContent":["\nexport default {\n  component: \"pe-control\",\n\n  // elements\n  formLabel: \"pe-control__form-label\",\n  input:     \"pe-control__input\",\n  label:     \"pe-control__label\",\n\n  // states\n  disabled:  \"pe-control--disabled\",\n  inactive:  \"pe-control--inactive\",\n  large:     \"pe-control--large\",\n  medium:    \"pe-control--medium\",\n  off:       \"pe-control--off\",\n  on:        \"pe-control--on\",\n  regular:   \"pe-control--regular\",\n  small:     \"pe-control--small\",\n\n  // control view elements\n  box:       \"pe-control__box\",\n  button:    \"pe-control__button\",\n\n  // control view states\n  buttonOff: \"pe-control__button--off\",\n  buttonOn:  \"pe-control__button--on\",\n};\n","import classes from \"polythene-css-classes/selection-control\";\n\nconst CONTENT = [\n  { iconType: \"iconOn\", className: classes.buttonOn},\n  { iconType: \"iconOff\", className: classes.buttonOff}\n];\n\nconst createIcon = (h, iconType, props, className) => (\n  // if props.iconOn/props.iconOff is passed, use that icon options object and ignore size\n  // otherwise create a new object\n  Object.assign(\n    {},\n    {\n      className,\n    },\n    props[iconType]\n      ? props[iconType]\n      : { svg: { content: h.trust(props.icons[iconType]) } },\n    props.icon,\n    props.size\n      ? { size: props.size }\n      : null\n  )\n);\n\nexport const _ViewControl = ({ h, Icon, IconButton, ...props }) => {\n  const element = props.element || `.${classes.box}`;\n  const content = h(IconButton, Object.assign({},\n    {\n      element: \"div\",\n      className: classes.button,\n      style: props.style,\n      content: CONTENT.map(o =>\n        h(Icon, createIcon(h, o.iconType, props, o.className))\n      ),\n      ripple: { center: true },\n      disabled: props.disabled,\n      events: props.events,\n      inactive: props.inactive\n    },\n    props.iconButton // for example for hover behaviour\n  ));\n  return h(element, null, content);\n};\n","import { filterSupportedAttributes, classForSize } from \"polythene-core\";\nimport classes from \"polythene-css-classes/selection-control\";\n\nexport const _SelectionControl = ({ h, a, useState, ViewControl, ...props }) => {\n  // remove unused props\n  delete props.key;\n\n  const defaultChecked = props.defaultChecked !== undefined\n    ? props.defaultChecked\n    : props.checked || false;\n  const [previousIsChecked, setIsChecked] = useState(defaultChecked);\n  \n  const isChecked = props.checked !== undefined\n    ? props.checked\n    : previousIsChecked;\n  const selectable = props.selectable !== undefined\n    ? props.selectable(isChecked)\n    : false;\n  const inactive = props.disabled || !selectable;\n  \n  const notifyChange = (e, isChecked) => {\n    if (props.onChange) {\n      props.onChange({\n        event: e,\n        checked: isChecked,\n        value: props.value\n      });\n    } \n  };\n\n  const onChange = e => {\n    let isChecked = e.currentTarget.checked;\n    if (props.type === \"radio\") {\n      // do not set directly\n    } else {\n      setIsChecked(isChecked);\n    }\n    notifyChange(e, isChecked);\n  };\n\n  const toggle = e => {\n    const newChecked = !isChecked;\n    setIsChecked(newChecked);\n    notifyChange(e, newChecked);\n  };\n\n  const viewControlClickHandler = props.events && props.events[a.onclick];\n  const viewControlKeyDownHandler = props.events && props.events[a.onkeydown]\n    ? props.events[a.onkeydown]\n    : e => {\n      if (e.key === \"Enter\" || e.keyCode === 32) {\n        e.preventDefault();\n        if (viewControlClickHandler) {\n          viewControlClickHandler(e);\n        } else {\n          toggle(e);\n        }\n      }\n    };\n\n  const componentProps = Object.assign(\n    {},\n    filterSupportedAttributes(props, { remove: [\"style\"] }), // Set style on view control\n    props.testId && { \"data-test-id\": props.testId },\n    {\n      className: [\n        classes.component,\n        props.instanceClass, // for instance pe-checkbox-control\n        isChecked ? classes.on : classes.off,\n        props.disabled ? classes.disabled : null,\n        inactive ? classes.inactive : null,\n        classForSize(classes, props.size),\n        props.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        props.tone === \"light\" ? \"pe-light-tone\" : null,\n        props.className || props[a.class],\n      ].join(\" \")\n    }\n  );\n\n  const content = h(\"label\",\n    Object.assign(\n      {},\n      {\n        className: classes.formLabel,\n      },\n      viewControlClickHandler && {\n        [a.onclick]: e => (\n          e.preventDefault(),\n          viewControlClickHandler(e)\n        )\n      }\n    ),\n    [\n      props.before,\n      h(ViewControl, Object.assign(\n        {},\n        props,\n        {\n          inactive,\n          checked: isChecked,\n          events: {\n            // Only use key down event; click events are handled by input element\n            [a.onkeydown]: viewControlKeyDownHandler\n          }\n        }\n      )),\n      props.label\n        ? h(`.${classes.label}`,\n          props.label\n        )\n        : null,\n      h(\"input\", Object.assign({},\n        props.events,\n        {\n          name: props.name,\n          type: props.type,\n          value: props.value,\n          checked: isChecked\n        },\n        props.disabled || inactive\n          ? { [a.readonly]: \"readonly\" }\n          : {\n            [a.onchange]: onChange\n          }\n      )),\n      props.after,\n    ]\n  );\n  return h(props.element || \"div\", componentProps, content);\n};\n"],"names":["component","formLabel","input","label","disabled","inactive","large","medium","off","on","regular","small","box","button","buttonOff","buttonOn","CONTENT","iconType","className","classes","h","a","useState","ViewControl","props","key","undefined","defaultChecked","checked","previousIsChecked","setIsChecked","isChecked","selectable","notifyChange","e","onChange","event","value","viewControlClickHandler","events","onclick","viewControlKeyDownHandler","onkeydown","keyCode","preventDefault","newChecked","toggle","componentProps","_extends","filterSupportedAttributes","remove","testId","instanceClass","classForSize","size","tone","join","content","before","name","type","readonly","onchange","currentTarget","after","element","Icon","IconButton","style","map","o","svg","trust","icons","icon","createIcon","ripple","center","iconButton"],"mappings":"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"}