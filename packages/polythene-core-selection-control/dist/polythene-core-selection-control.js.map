{"version":3,"file":"polythene-core-selection-control.js","sources":["../../polythene-css-classes/selection-control.js","../src/selection-control.js","../src/view-control.js"],"sourcesContent":["\nexport default {\n  component: \"pe-control\",\n\n  // elements\n  formLabel: \"pe-control__form-label\",\n  input:     \"pe-control__input\",\n  label:     \"pe-control__label\",\n\n  // states\n  disabled:  \"pe-control--disabled\",\n  inactive:  \"pe-control--inactive\",\n  large:     \"pe-control--large\",\n  medium:    \"pe-control--medium\",\n  off:       \"pe-control--off\",\n  on:        \"pe-control--on\",\n  regular:   \"pe-control--regular\",\n  small:     \"pe-control--small\",\n\n  // control view elements\n  box:       \"pe-control__box\",\n  button:    \"pe-control__button\",\n\n  // control view states\n  buttonOff: \"pe-control__button--off\",\n  buttonOn:  \"pe-control__button--on\",\n};\n","import { filterSupportedAttributes, classForSize } from \"polythene-core\";\nimport classes from \"polythene-css-classes/selection-control\";\n\nexport const getElement = vnode =>\n  vnode.attrs.element || \"div\";\n\nconst currentState = (attrs, state) => {\n  const checked = attrs.checked !== undefined\n    ? attrs.checked\n    : state.checked();\n  const selectable = attrs.selectable !== undefined\n    ? attrs.selectable(checked)\n    : false;\n  const inactive = attrs.disabled || !selectable;\n  return { checked, inactive };\n};\n\nexport const getInitialState = (vnode, createStream, { keys: k }) => {\n  const attrs = vnode.attrs;\n  const isChecked = attrs.defaultChecked !== undefined\n    ? attrs.defaultChecked\n    : attrs.checked || false;\n  const checked = createStream(isChecked);\n\n  const notifyChange = (e, isChecked) => {\n    if (attrs.onChange) {\n      attrs.onChange({\n        event: e,\n        checked: isChecked,\n        value: attrs.value\n      });\n    } \n  };\n\n  const onChange = e => {\n    let isChecked = e.currentTarget.checked;\n    if (attrs.type === \"radio\") {\n      // do not set directly\n    } else {\n      checked(isChecked);\n    }\n    notifyChange(e, isChecked);\n  };\n\n  const toggle = e => {\n    const newChecked = !checked();\n    checked(newChecked);\n    notifyChange(e, newChecked);\n  };\n\n  const viewControlClickHandler = attrs.events && attrs.events[k.onclick];\n  const viewControlKeyDownHandler = attrs.events && attrs.events[k.onkeydown]\n    ? attrs.events[k.onkeydown]\n    : e => {\n      if (e.key === \"Enter\" || e.keyCode === 32) {\n        e.preventDefault();\n        if (viewControlClickHandler) {\n          viewControlClickHandler(e);\n        } else {\n          toggle(e);\n        }\n      }\n    };\n\n  return {\n    checked,\n    toggle,\n    onChange,\n    viewControlClickHandler,\n    viewControlKeyDownHandler,\n    redrawOnUpdate: createStream.merge([checked])\n  };\n};\n\nexport const createProps = (vnode, { keys: k }) => {\n  const attrs = vnode.attrs;\n  const state = vnode.state;\n  const { checked, inactive } = currentState(attrs, state);\n  return Object.assign(\n    {},\n    filterSupportedAttributes(attrs),\n    {\n      className: [\n        classes.component,\n        attrs.instanceClass, // for instance pe-checkbox-control\n        checked ? classes.on : classes.off,\n        attrs.disabled ? classes.disabled : null,\n        inactive ? classes.inactive : null,\n        classForSize(classes, attrs.size),\n        attrs.tone === \"dark\" ? \"pe-dark-tone\" : null,\n        attrs.tone === \"light\" ? \"pe-light-tone\" : null,\n        attrs.className || attrs[k.class],\n      ].join(\" \")\n    }\n  );\n};\n\nexport const createContent = (vnode, { renderer: h, keys: k, ViewControl }) => {\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  const { checked, inactive } = currentState(attrs, state);\n  \n\n  return h(\"label\",\n    Object.assign(\n      {},\n      {\n        className: classes.formLabel,\n      },\n      state.viewControlClickHandler && {\n        [k.onclick]: e => (\n          e.preventDefault(),\n          state.viewControlClickHandler(e)\n        )\n      }\n    ),\n    [\n      h(ViewControl, Object.assign(\n        {},\n        attrs,\n        {\n          inactive,\n          checked,\n          key: \"control\",\n          events: {\n            // Only use key down event; click events are handled by input element\n            [k.onkeydown]: state.viewControlKeyDownHandler\n          }\n        }\n      )),\n      attrs.label\n        ? h(`.${classes.label}`,\n          { key: \"label\" },\n          attrs.label\n        )\n        : null,\n      h(\"input\", Object.assign(\n        {},\n        attrs.events,\n        {\n          name: attrs.name,\n          type: attrs.type,\n          value: attrs.value,\n          checked\n        },\n        attrs.disabled || inactive\n          ? { disabled: \"disabled\" }\n          : {\n            [k.onchange]: state.onChange\n          }\n      ))\n    ]\n  );\n};\n","import classes from \"polythene-css-classes/selection-control\";\n\nconst CONTENT = [\n  { iconType: \"iconOn\", className: classes.buttonOn},\n  { iconType: \"iconOff\", className: classes.buttonOff}\n];\n\nexport const getElement = vnode =>\n  vnode.attrs.element || `.${classes.box}`;\n\nconst createIcon = (h, iconType, attrs, className) => (\n  // if attrs.iconOn/attrs.iconOff is passed, use that icon options object and ignore size\n  // otherwise create a new object\n  Object.assign(\n    {},\n    {\n      className,\n      key: iconType\n    },\n    attrs[iconType]\n      ? attrs[iconType]\n      : { svg: { content: h.trust(attrs.icons[iconType]) } },\n    attrs.icon,\n    attrs.size\n      ? { size: attrs.size }\n      : null\n  )\n);\n\nexport const createContent = (vnode, { renderer: h, Icon, IconButton }) => {\n  const attrs = vnode.attrs;\n  return h(IconButton, Object.assign(\n    {},\n    {\n      element: \"div\",\n      key: attrs.key,\n      className: classes.button,\n      content: CONTENT.map(o =>\n        h(Icon, createIcon(h, o.iconType, attrs, o.className))\n      ),\n      ripple: { center: true },\n      disabled: attrs.disabled,\n      events: attrs.events,\n      inactive: attrs.inactive\n    },\n    attrs.iconButton // for example for hover behaviour\n  ));\n};\n"],"names":["component","formLabel","input","label","disabled","inactive","large","medium","off","on","regular","small","box","button","buttonOff","buttonOn","getElement","vnode","attrs","element","currentState","state","checked","undefined","selectable","getInitialState","createStream","keys","k","isChecked","defaultChecked","notifyChange","e","onChange","event","value","currentTarget","type","toggle","newChecked","viewControlClickHandler","events","onclick","viewControlKeyDownHandler","onkeydown","key","keyCode","preventDefault","redrawOnUpdate","merge","createProps","Object","assign","filterSupportedAttributes","className","classes","instanceClass","classForSize","size","tone","class","join","createContent","renderer","h","ViewControl","name","onchange","CONTENT","iconType","createIcon","svg","content","trust","icons","icon","Icon","IconButton","map","o","ripple","center","iconButton"],"mappings":"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"}